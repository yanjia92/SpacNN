st China Normal University
硕士学位论文
MASTER’S DISSERTATION
面向复杂随机系统的贝叶斯统计模型检测 方法
       院  系:
       专  业:
       研究方向:
       指导教师:
       学位申请人:
       计算机科学与软件工程学院 软件工程 高可信计算理论与技术
       张 敏 副教授
           何 佳 2016年5月
            
            2016 Master Thesis School Code: 10269 Student Number: 51131500016
                                         Bayesian Statistical Model Checking for Complex Stochastic Systems
                                         Department:
                                         Major: Subject: Tutor: Author:
                                         School of Computer Science and Software Engineering
                                         Software Engineering
                                         Trustworthy Computing Theory and Technology Assoc Prof. Min Zhang
                                         Jia He
                                         2016.5
                                               
                                                    华东师范大学学位论文原创性声明
                                                    郑重声明:本人呈交的学位论文《面向复杂随机系统的贝叶斯统计模 型检测方法》,是在华东师范大学攻读硕士/博士(请勾选)学位期间,在导 师的指导下进行的研究工作及取得的研究成果。除文中已经注明引用的内 容外,本论文不包含其他个人已经发表或撰写过的研究成果。对本文的研 究做出重要贡献的个人和集体,均已在文中作了明确说明并表示谢意。
                                                    作者签名: 日期: 年 月 日
                                                        华东师范大学学位论文著作权使用声明
                                                        《面向复杂随机系统的贝叶斯统计模型检测方法》系本人在华东师范大学攻 读学位期间在导师指导下完成的硕士/博士(请勾选)学位论文,本论文的著作权 归本人所有。本人同意华东师范大学根据相关规定保留和使用此学位论文,并向 主管部门和学校指定的相关机构送交学位论文的印刷版和电子版;允许学位论文 进入华东师范大学图书馆及数据库被查阅、借阅;同意学校将学位论文加入全国 博士、硕士学位论文共建单位数据库进行检索,将学位论文的标题和摘要汇编出 版,采用影印、缩印或者其它方式合理复制学位论文。
                                                        本学位论文属于(请勾选)
                                                        ( )1.经华东师范大学相关部门审查核定的“内部”或“涉密”学位论文
                                                        *,于 年 月 日解密,解密后适用上述授权。 (√)2.不保密,适用上述授权。
                                                        导师签名 本人签名
                                                        * “涉密”学位论文应是已经华东师范大学学位评定委员会办公室或保密委员会审定 过的学位论文(需附获批的《华东师范大学研究生申请学位论文“涉密”审批表》方 为有效),未经上述部门审定的学位论文均为公开学位论文。此声明栏不填写的,默 认为公开学位论文,均适用上述授权)。
                                                        年月日
                                                        何佳 硕士学位论文答辩委员会成员名单
                                                              姓名
                                                                    职称
                                                                         单位
                                                                              备注
                                                                                  朱惠彪
                                                                                      教授
                                                                                         华东师范大学,计算
                                                                                         机科学与软件工程学
                                                                                         院
                                                                                            主席
                                                                                                郭建
                                                                                                 副教授
                                                                                                  华东师范大学,计算
                                                                                                  机科学与软件工程学
                                                                                                  院
                                                                                                        张民
                                                                                                           副教授
                                                                                                              华东师范大学,计算
                                                                                                              机科学与软件工程学
                                                                                                              院
                                                                                                                                                                                  
                                                                                                                                                                                  摘要
                                                                                                                                                                                  随着网络技术的成熟,加速了各类网络设施、应用和服务的发展,如移动互 联网、云计算等。它们渗透进了人们生活的方方面面。越来越多的设施与应用会 建立在网络之上。研究如何保证它们的正确性和可靠性就变成一个有意义的课题。 不同于其他软硬件系统,网络系统往往包含随机性。虽然业界目前主要采用测试 来保证软硬件系统的正确性和可靠性。但是它也存在一些不足,如没有把握保证 检测出系统所有的错误和其效果与测试者的经验有较大关联等。
                                                                                                                                                                                  为更好地保证复杂随机系统的正确性和可靠性,我们提出了一种基于预测的 贝叶斯统计模型检测方法(prediction-based Bayesian model checking)。从模型的 初始状态开始,随机从模型中选择一条有限路径,并多次重复这个过程。由于有 限路径是相互独立的,因此就能将所有的有限路径看作为样本,并通过贝叶斯推 断(Bayesian Inference)来推断模型满足性质的概率。
                                                                                                                                                                                  另外,我们利用贝叶斯统计学中先验分布与后验分布的共轭关系,在验证前 预测所需样本的数量上限。并且保证一旦抽样数量达到该上限时,当前的结果已 经达到了可信度与精度的要求,可立即返回。其次,根据之前所预测的上限,我 们会在每次统计数据更新后,再次利用共轭关系来预测所有可能的推断结果。当 所有可能的结果都与当前结果一致时,便直接返回结果。
                                                                                                                                                                                  为提高对一部分复杂系统的验证效率(运行周期较长的随机系统),我们另 外提出了一种启发式的抽样与验证算法。它将路径抽样与路径验证分开成两个阶 段:在对路径进行验证时,尝试利用算法来定位一个“可判前缀”,而这个“可 判前缀”能够直接用来判定该路径是否满足性质。而在后续的抽样中,根据之前 所收集的“可判前缀”信息,便可以直接判断路径是否满足性质。从而避免耗时 的路径验证。并且,它还可以与基于预测的贝叶斯统计模型检测算法相结合。
                                                                                                                                                                                  SPAC(Statistical Probabilistic Approximate model Checker)是基于上述算法所
                                                                                                                                                                                  实现的统计模型检测工具。通过 SPAC 对调度算法、分布式算法等案例进行研究 i
                                                                                                                                                                                  后,发现在一些场景下,该算法相对于其他统计模型检测算法效率更高。并且对 于运行周期较长的系统,启发式算法也可以进一步提高验证效率。
                                                                                                                                                                                  关键词: 统计模型检测;复杂随机系统;贝叶斯推断;启发式算法;预测;SPAC
                                                                                                                                                                                  ii
                                                                                                                                                                                  ABSTRACT
                                                                                                                                                                                  As Internet technologies step into maturity, they accelerate the development of Internet infrastructures, applications and services, such as mobile Internet, cloud computing and so on. They permeate into every corner of people's daily life. More and more infrastructures and applications will be built on networks. Investigating how to ensure their correctness and stableness is valuable. Different from other software or hardware systems, network systems contain stochastic behaviors. Testing is applied widely in industry to accomplish this object, but it still contains some deficiencies, such as not being able to find out all of the bugs and being closely related to testers’ experience.
                                                                                                                                                                                  To ensure correctness and stableness of complex stochastic systems, we propose a prediction-based Bayesian statistical model checking approach - PBMC. If we randomly sample a finite path from the initial state in a model, and repeat this procedure, then we get independent paths. If we regard them as samples, then we are able to infer the probability of the model satisfying for a property.
                                                                                                                                                                                  Furthermore, utilizing conjugate relation between prior distribution and posterior distribution in Bayesian Statistics, we can predict the size of samples needed. And requirements on confidence and precision of result are sure to be satisfied when the number of samples reaches this size. Secondly, according to prediction, we can utilize conjugate relation again to predict all of the possible results after statistics have been updated. If all the predicting results consent to current result, it will be returned as final result directly.
                                                                                                                                                                                  To enhance the efficiency of verifying one type of systems (long-term running stochastic systems), we proposed another heuristic sampling and verifying algorithm. It separates sampling and verification into two steps: In verification, we use an algorithm to find out a "decidable" path prefix. And this prefix is able to determine
                                                                                                                                                                                  whether the path satisfies the property. Then, in the following sampling steps, we may
                                                                                                                                                                                  iii
                                                                                                                                                                                  be able to directly determine whether the path satisfies the property. Moreover, this approach can be integrated with PBMC.
                                                                                                                                                                                  SPAC (Statistical Probabilistic Approximate model Checker) is a statistical model checker which implements several approaches above. We verify scheduling algorithm and distributed algorithms with SPAC. It shows that PBMC is more efficient than APMC and SPRT in some cases. Especially, for long-run term stochastic systems, heuristic algorithms can further enhance the efficiency of verification.
                                                                                                                                                                                  Keywords: statistical model checking; complex stochastic systems; Bayesian Inference; heuristic algorithm; prediction; SPAC
                                                                                                                                                                                  iv
                                                                                                                                                                                  目录
                                                                                                                                                                                  摘 要 ........................................................... i ABSTRACT ........................................................ iii 目 录............................................................v 插图清单 ....................................................... viii 附表清单 ......................................................... ix 第一章 绪论 ....................................................... 1
                                                                                                                                                                                  1.1 研究背景......................................................1 1.2 研究动机......................................................4 1.3 相关工作......................................................6 1.4 文章结构......................................................7
                                                                                                                                                                                  第二章 背景知识 ................................................... 9
                                                                                                                                                                                  2.1 模型定义与性质描述............................................9
                                                                                                                                                                                  2.1.1 离散时间马尔可夫链与概率迁移系统..........................9 2.1.2 事件的测度................................................9 2.1.3 概率计算树逻辑 PCTL ......................................10
                                                                                                                                                                                  2.2 贝叶斯推断...................................................11
                                                                                                                                                                                  2.2.1 贝叶斯推断与先验信息.....................................11 2.2.2 贝叶斯推断过程...........................................12 2.2.3 共轭先验分布定理.........................................13
                                                                                                                                                                                  2.3 本章小结.....................................................13
                                                                                                                                                                                  第三章 基于预测的贝叶斯统计模型检测方法 .......................... 14
                                                                                                                                                                                  3.1 基本介绍.....................................................14 3.2 面向定性性质的验证算法.......................................15 3.2.1 方法框架.................................................15 3.2.2 抽样数量上限预测方法.....................................17 3.2.3 面向定性性质的统计结果预测方法...........................19 3.2.4 结果可信度计算方法.......................................21
                                                                                                                                                                                  v
                                                                                                                                                                                  3.2.5 算法描述.................................................22
                                                                                                                                                                                  3.3 面向定量性质的检测算法.......................................24
                                                                                                                                                                                  3.3.1 方法框架.................................................24 3.3.2 面向定量性质的统计结果预测方法...........................24 3.3.3 算法描述.................................................26
                                                                                                                                                                                  3.4 启发式抽样与验证算法.........................................28
                                                                                                                                                                                  3.4.1 方法框架.................................................28 3.4.2 一个基本观察.............................................29 3.4.3 最短可判前缀.............................................30 3.4.4 启发式抽样与验证算法.....................................35
                                                                                                                                                                                  3.5 完整算法验证过程.............................................40
                                                                                                                                                                                  3.6 本章小结.....................................................42
                                                                                                                                                                                  第四章 统计模型检测工具 SPAC...................................... 43
                                                                                                                                                                                  4.1 工具介绍 .....................................................43 4.2 工具实现 .....................................................44 4.2.1 界面与配置模块...........................................45 4.2.2 参数检查模块.............................................45 4.2.3 DTMC 模型构建模块 ........................................45 4.2.4 PCTL 语法解析模块 ........................................46 4.2.5 统计模型检测算法模块.....................................46 4.2.6 有限路径验证模块.........................................47 4.3 本章小结.....................................................47 第五章 案例研究 .................................................. 49 5.1 基本介绍.....................................................49 5.2 简单随机调度算法.............................................49 5.2.1 简单随机调度算法介绍.....................................50 5.2.2 算法正确性评估...........................................51 5.2.3 不同运行周期下的验证效率评估.............................52 5.2.4 指定不同先验分布时的验证效率评估.........................53 5.2.5 不同概率阈值下的验证效率评估.............................55 5.3 同步的领导者选举协议.........................................56 5.3.1 同步的领导者选举协议介绍.................................56
                                                                                                                                                                                  vi
                                                                                                                                                                                  5.3.2 面向定量性质的验证效率评估...............................56 5.3.3 指定不同先验分布时的验证效率评估.........................58 5.3.4 不同概率阈值下的验证效率评估.............................59 5.3.5 不同问题规模下的验证效率评估.............................60
                                                                                                                                                                                  5.4 Herman 分布式算法 ............................................62
                                                                                                                                                                                  5.4.1 Herman 分布式算法介绍 ....................................62 5.4.2 面向定量性质的验证效率评估...............................64 5.4.3 不同运行周期下的验证效率评估.............................65 5.4.4 复杂问题的验证效率.......................................67
                                                                                                                                                                                  5.5 本章小结.....................................................67
                                                                                                                                                                                  第六章 总结与展望 ................................................ 69
                                                                                                                                                                                  6.1 总结.........................................................69
                                                                                                                                                                                  6.2 展望.........................................................70
                                                                                                                                                                                  附录 A 启发式验证算法中的关键状态定位算法 ......................... 71 附录 B 简单随机调度算法在 PRISM 中的模型定义 ....................... 74 附录 C 抽样上限预测算法........................................... 76 附录 D 同步领导者选举协议在 PRISM 中的模型定义 ..................... 78 附录 E 读硕士学会期间发表论文和科研情况 ........................... 82 致 谢...........................................................88
                                                                                                                                                                                  vii
                                                                                                                                                                                  插图清单
                                                                                                                                                                                  图 1 不同抽样方式的统计模型检测方法框架 ............................ 3 图 2 面向定性性质的验证算法框架................................... 15 图 3 面向定量性质的验证算法框架................................... 25 图 4 启发式抽样与验证算法框架..................................... 28 图 5 使用硬币模仿骰子的马尔可夫链 ................................. 29 图 6 SPAC 的图形操作界面 .......................................... 43 图 7 SPAC 模块结构图 .............................................. 44 图 8 Approach 类的子类结构 ........................................ 46 图 9 一种可能的打印机分配方案..................................... 50 图 10 PBMC、SPRT 在指定不同 时的验证次数 .......................... 60 图 11 PBMC 在验证不同规模问题时的验证次数 ......................... 61 图 12 一个简单的 Herman 自满足算法例子 ............................. 64
                                                                                                                                                                                  viii
                                                                                                                                                                                  附表清单
                                                                                                                                                                                  表 1 收集关键状态的过程........................................... 41 表 2 PBMC、APMC 和 SPRT 的验证结果与正确性 ......................... 52 表 3 PBMC、APMC 的验证次数比较 .................................... 53 表 4 PBMC 在指定不同先验函数时的验证结果与验证次数 ................ 54 表 5 PBMC、SPRT 在指定不同概率阈值时的验证次数 .................... 55 表 6 PBMC、APMC 在指定不同参数时的验证次数(同步领导者选举算法)..... 57 表 7 PBMC 在指定不同先验分布时的验证次数 .......................... 58 表 8 PBMC、APMC 在指定不同参数时的验证次数(Herman 算法) .......... 65 表 9 PBMC、APMC 在指定不同时间长度时的验证次数与结果............... 66
                                                                                                                                                                                  ix
                                                                                                                                                                                  第一章 绪论
                                                                                                                                                                                  1.1 研究背景
                                                                                                                                                                                    第一章 绪论
                                                                                                                                                                                    1.1 研究背景
                                                                                                                                                                                    近五年来,由于网络技术的完全成熟,大大推动了上层技术领域的发展,如 移动互联网,云计算等。它们或提供了便利,或形成了信息基础设施。并且,它 们继续保持迅猛的发展势头,渗透进了人们生活的方方面面。可以预见,随着信 息技术的进一步发展,会有越来越多的设施与应用会建立在网络之上。因此,如 何保证它们的正确性和可靠性就变成一个有意义的课题。然而,网络系统往往包 含随机性,这也为这一课题增加了更多的难度。目前,工业界广泛采用测试来保 证软硬件系统的正确性。这主要由于测试执行起来相对方便,且直接实施于软硬 件系统本身,比较直观。
                                                                                                                                                                                    然而,测试也存在许多不尽如人意的地方:首先,测试不能保证检测出系统 所有的缺陷(bug),测试的效率和效果往往较多地取决于测试人员的经验和熟练 程度。其次,由于测试流程滞后于开发流程。虽然工业界普遍在开发流程中采用 多种类型的测试(如单元测试、集成测试等)来检验系统的质量,但是会需要多 次重复“测试,修复,测试,修复”这种开发迭代过程来尽可能减少系统中的缺陷。 最后,对于复杂度较高的系统,一般会先对子系统进行测试,再对整个系统进行 集成测试。而这类集成测试的代价较大,并且问题的排查也比一般系统复杂。
                                                                                                                                                                                    形式化验证(formal verification)是另一类可用来保证系统正确性与可靠性 的方法。在大部分情况下,它们尝试探寻系统所有可能的行为,如此来保证系统 所有的行为都是符合预期的。而本文主要关注的模型检测技术(model checking) 是形式化验证方法中的一种。它最初分别由 Clarke 和 Emerson 在[1]中提出与 Queille 和 Sifakis 在[3]提出,并因为 Clarke 和 Emerson 的工作而发展[2]。
                                                                                                                                                                                    1
                                                                                                                                                                                    第一章 绪论 1.1 研究背景
                                                                                                                                                                                      如果要对系统进行模型检测,首先需要为系统建立相应的数学模型,如 Kripke 结构(Kripke structures)[4]等。建立模型的目的是抽象出系统所有可能的 行为,从而使得验证可以直接实施于抽象模型之上。其次,还需要为单次验证指 定性质。它主要来表示系统预期的行为,如“系统最终会终止”。目前一般使用时 序逻辑(temporal logic)来描述性质,如线性时序逻辑(linear time logic,LTL) [5]、计算树逻辑(computation tree logic,CTL)[6][7]等。最后,模型检测通过算 法来判定模型是否满足性质,也即模型的行为与预期是否一致。如果不满足,则 给出相应的反例(counter example)。
                                                                                                                                                                                      它解决了之前测试所存在的几个痛点:第一,模型检测使用数学模型对系统 抽象,理论上可以遍历所有系统可能的行为。因此可以在最大程度上保证系统的 正确性和可靠性。第二,模型检测的检测过程主要基于算法。除去建模与性质指 定,大部分验证过程都是自动化的。相对于测试,可以节省大部分的人力,并且 也减少了验证效果与验证实施人员经验的关联度。第三,不需要通过观察系统本 身的行为来进行检测。所以,它不仅可以辅助系统设计,也能够帮助尽早地发现 设计中的问题。
                                                                                                                                                                                      概率模型检测(probabilistic model checking)[8][9]是模型检测技术中的一个 研究分支。它主要用于验证包含随机行为的系统。在实际生产中,对于这类随机 系统,定量性质更加受到关注,如“系统达到稳定状态的概率大于 99%。”或“消 息丢失的概率小于 1%”等。概率模型检测主要利用马尔可夫链(Markov chain, MC)[10][11]、马尔可夫决策过程(Markov decision process,MDP)[12]等对系 统建模。并利用带有概率特性的时序逻辑如概率计算树逻辑(probabilistic computation tree logic,PCTL)来描述性质。最后通过算法来给出验证结果。
                                                                                                                                                                                      由于经典模型检测需要对模型进行穷尽式的分析,因此需要在验证时遍历整 个模型。所以模型复杂度是影响验证效率的关键因素之一。然而,对于一些复杂 系统,其模型所包含的状态数量往往较大。另外,在对一些存在并行模块的系统 进行建模时,如果并行模块数量增加,就会导致该模型状态数量指数倍增长。这 即是应用模型检测所面临的主要问题:状态爆炸(state explosion)[2]问题。目前
                                                                                                                                                                                      2
                                                                                                                                                                                      第一章 绪论 1.1 研究背景
                                                                                                                                                                                        有多种方法来尝试解决这个问题,如符号模型检测(symbolic model checking) [14][15]、偏序归约(partial reduction[16][17][18])等。它们使得模型检测可用于 验证更加复杂的系统,但是挑战依然存在。
                                                                                                                                                                                        图 1 不同抽样方式的统计模型检测方法框架
                                                                                                                                                                                        Fig.1 Statistical model checking frameworks with different sampling plan 统计模型检测(statistical model checking)是概率模型检测方法中的一类。 它或称为近似概率模型检测(approximate probabilistic model checking)。它换了 一种角度去解决这个问题,它实际上是一种基于蒙特卡罗方法(Monte Carlo method)的技术。它的建模与性质指定部分与概率模型检测基本相同。不同的是, 它采用统计学中的方法来对系统进行验证。在完成建模与性质描述后,通过随机 抽样大量的有限路径来作为样本。并基于这些样本,通过参数估计、假设检验等 方法来对模型进行分析,并给出解。所以,它的时间、空间复杂度与模型复杂度 无关。不过由于通过统计方法来对模型进行分析,所以只能给出近似的解。相对 于穷尽式的模型检测算法,它比较适合验证复杂度较高的随机系统,如分布式随
                                                                                                                                                                                        机算法[19]、传感器网络[20]、调度算法[21]和生物系统[22][23]等。
                                                                                                                                                                                        目前的统计模型检测方法可以大致分为两类:参数估计式和假设检验式[27]。 3
                                                                                                                                                                                         
                                                                                                                                                                                         第一章 绪论 1.2 研究动机
                                                                                                                                                                                           两者在求解的问题类型上,有一些区别:在收集到足够的样本后,前者会基 于这些样本,给出模型满足给定性质的近似概率,属于定量的结果。而后者用于 判定模型是否满足给定性质,属于定性的结果。
                                                                                                                                                                                           除此之外,在抽样方式上,也可以分成两类(见图 1):第一类是简单固定数 量抽样方案[28][29],它先根据可信度等要求,确定所需要的抽样数量。然后进行 抽样。而第二类是序贯抽样方案(sequential sampling)[30],它也需要先给定一 个可信度要求。在每次抽样完成后,它会计算目前结果的可信度。如果可信度未 达到要求,则继续抽样。一旦可信度达到要求,则立即停止抽样,并返回结果。
                                                                                                                                                                                           1.2 研究动机
                                                                                                                                                                                           通常,根据统计学来获得验证结果只需常数时间复杂度的操作。因此,在大 多数情况下,影响统计模型检测效率的主要因素有:路径抽样次数、路径验证次 数。
                                                                                                                                                                                           首先,由于统计模型检测需要对模型抽样有限路径。因此,它主要用于验证 时间有界的性质(time-bounded properties)[31]。而当要在一个更长的运行周期 上验证性质时,就需要抽样更长的路径。举个例子,Herman 分布式算法[32]主要 用于组织一个环状网络中的进程进行令牌交换,并最终达到一个稳定状态。而当 系统中包含的进程数量越多时,整个系统达到稳定状态所需的时间就越长。因此, 假设存在一个规模较大的环状网络,如果需要估计它达到稳定状态的时间,就需 要在算法开始后一个较长的周期内,分析其状态迁移过程。
                                                                                                                                                                                           但这对统计模型验证的效率影响较大。考虑以下情况:假设对一个系统进行 验证时,需要抽样 n 次。如果将它看作多次伯努利实验[27]。为了知道每次试验 是“成功的”或“失败的”,则同样需要对路径验证 n 次。然而,路径验证的时间复 杂度要比路径抽样高的多(CTL 的验证时间复杂度至少是 PTIME,LTL 的验证 时间复杂度至少是 PSPACE-complete[33],而路径抽样至多只需要与路径长度呈 正比的线性时间复杂度)。因此,假设验证一条长度为 k 的路径的时间复杂度至 少为 O(k¥|y |),其中|y |是所需验证性质的复杂度。忽略其他次要操作时间,
                                                                                                                                                                                           4
                                                                                                                                                                                           第一章 绪论 1.2 研究动机
                                                                                                                                                                                             则抽样n次并验证n次的时间复杂度就是O(n¥k¥|y |)。而当所需验证的路径长 度k增大1时,所需验证时间就会增大n¥|y |。而在一个较长的周期上验证性质 时,由于需要抽样的路径长度 k 会较一般抽样路径长许多。因此,其所需的验证 时间也会相应快速增长。
                                                                                                                                                                                             为解决上述问题,本文会提出一种启发式的模型检测算法。它将路径抽样与 路径验证分开成两个阶段:在对路径进行验证时,尝试利用算法来定位一个“最 短可判前缀”,而这个“最短可判前缀”能够直接用来判定该路径是否满足性质。 这样一来,在后续的抽样中,根据之前所收集的“最短可判前缀”信息,便可以 直接判断路径是否满足性质。从而避免重复验证该条路径。
                                                                                                                                                                                             其次,对于大多数方法,如果对结果的可信度与精度要求越高,则所需抽样、 验证的路径样本就更多。比如“结果的可信度高于 99.999%”所需要的样本数量就 多于“结果的可信度高于 99%”。而这也会造成所需路径样本的数量快速上升,这 也限制了统计模型检测的应用。
                                                                                                                                                                                             为了提高在高可信度与高精度要求下,对于随机系统的验证效率,我们提出 了一种基于预测的贝叶斯统计模型检测方法。
                                                                                                                                                                                             我们主要使用贝叶斯推断(Bayesian inferences)来对结果进行估计或者检验。 首先,我们利用贝叶斯统计学中先验函数与后验函数的共轭关系[35],在验证前 预测所需样本的数量上限。并且保证一旦抽样数量达到该上限时,当前的结果已 经达到了可信度与精度的要求,可以立即返回。其次,根据之前所预测的上限, 我们会在每次统计数据更新后,利用先后验分布之间的共轭关系来预测所有可能 的结果。当所有可能的结果都与当前结果一致时,便直接返回结果。
                                                                                                                                                                                             除此之外,在一些场合下,系统往往具有先验信息,如“消息发送成功的概 率大于 50%”或“系统一周内宕机的概率小于 50%”等类似经验。由于贝叶斯统计 学可以将这类信息,作为除样本之外的重要信息来源。而本文提出的方法也支持 指定先验分布,并由此减少所需样本抽样与验证次数,提高验证效率。
                                                                                                                                                                                             5
                                                                                                                                                                                             第一章 绪论
                                                                                                                                                                                             1.3 相关工作
                                                                                                                                                                                               1.3 相关工作
                                                                                                                                                                                               在[25]中,Thomas 和 Richard 引入了一种基于参数估计的验证方法 APMC(Approximate Probabilistic Model Checking),主要应用于离散时间的随机系 统验证。它使用离散时间的马尔可夫链(discrete time Markov chain,DTMC)来进 行建模,并在其上验证定量的性质。它使用简单固定抽样方案。起先,它要求给 出两个参数:可信度参数d 和近似参数e 。基于这两个参数,他们使用 Chernoff 界[34]来计算所需的样本数量 N。并保证结果满足 Prob[ | A( x, e , d ) - μ ( x) | ] ≥ 1 - d , 即验证结果偏离实际概率大于e 的概率小于d 。随后开始抽样随机路径并验证。 在过程中,该方法会记录下 A,即满足性质的路径条数。在完成 N 次抽样和验证 后,最终使用 A/N 来估计模型满足给定性质的概率。基于这套算法,Thomas 等 实现了相应的验证工具 APMC(Approximate Probabilistic Model Checker,APMC)。
                                                                                                                                                                                               在[25]的案例研究中,它们使用 APMC 对哲学家问题进行了验证[38],并与 另一种概率模型检测工具 PRISM[36]进行了比较。根据其结果:在当少于 20 个 哲学家时,PRISM 的验证效率要略好于 APMC。而当哲学家的数量达到 25 个时, PRISM中的模型已经包含1.14¥1024 个状态,并在抽样数量上开始落后于APMC。 而当哲学家数量大于 25 个时,PRISM 由于模型状态数量过大而出现内存不足无 法验证的情况。APMC 由于每次仅需要抽样一条路径,因此即使哲学家数量达到 100 时,它依然能够给出相应的解。而目前 PRISM 也已经实现了 APMC 算法[36]。
                                                                                                                                                                                               在[39]中,Younes提出了一种基于Wald序贯概率比率测试(Wald’ssequential probability ratio test,SPRT)[30]的方法。它实际是一种假设检验式的方法,因此 主要用于验证定量的性质。在验证前,需要分别将“模型满足性质”作为原假设, 将“模型不满足性质”作为备选假设,并通过收集样本并进行统计来选择其中一个 假设。它使用了序贯抽样方案(sequential sampling plan),因此其抽样数量并非 是固定的。在抽样过程中,它主要通过计算两种情况的条件概率比例来确定当前 结果的可信度。
                                                                                                                                                                                               在[39]的案例研究中,他们使用序贯抽样方案和简单固定数量抽样方案对若 干案例进行了验证,并作了比较。而在四个案例中,序贯抽样方案的效率都好于
                                                                                                                                                                                               6
                                                                                                                                                                                               第一章 绪论 1.4 文章结构
                                                                                                                                                                                                 简单抽样方案。
                                                                                                                                                                                                 在[22]中,Jha 和 Clarke 提出了一种基于贝叶斯因子的方法。它也基于假设
                                                                                                                                                                                                 检验。其主要过程与 Younes 提出的方法[39]类似。但是也存在区别:Jha 等通过 计算贝叶斯因子[40]来作为当前结果的可信度。类似地,它使用“模型满足性质” 和“模型不满足性质”分别作为假设,并需要指定 T 来作为可信度阈值。当贝叶斯 因子 B>T 或 B<=1/T 时,则选择其中的一个假设作为判定结果。另外,由于该方 法基于贝叶斯统计学,这使得其也能够利用先验信息指定先验函数,来进一步减 少抽样的数量。
                                                                                                                                                                                                 在[26]中,Zuliani 和 Platzer 也提出了一种基于贝叶斯统计学的方法。它基于 贝叶斯区间估计来推断模型满足性质的概率。但是它却采用了序贯抽样方案:在 每次抽样结束后,它都通过后验函数的区间积分来计算当前结果的可信度。当可 信度足够高时,相应的区间则就是对满足概率的估计。而与[22]相同的是,它也 支持通过指定先验函数的方式,来减少抽样的次数。
                                                                                                                                                                                                 1.4 文章结构
                                                                                                                                                                                                 文章主要包含六个章节。除本章以外,分别依次介绍了课题相关的背景知识, 方法框架与具体方法、实现的工具、案例研究以及总结与展望。基本内容主要如 下:
                                                                                                                                                                                                 1. 第二章 背景知识
                                                                                                                                                                                                 该章节主要给出用于系统建模的 DTMC 等概率模型定义、用来描述性质的 概率计算树逻辑(probabilistic computation tree logic,PCTL)[10]的满足关系。除 此之外,还介绍了贝叶斯统计学中贝叶斯推断的相关内容,以便于引入验证算法。 2. 第三章 基于预测的贝叶斯统计模型检测方法(prediction-based Bayesian
                                                                                                                                                                                                 statistical model checking,PBMC) 该章节分为三部分,分别介绍了面向定性性质、面向定量性质的基于预测的 贝叶斯统计模型检测算法和启发式抽样验证算法。并分别在各个部分中描述 其所包含的关键步骤,如路径抽样上限预测方法、统计结果预测方法和路径
                                                                                                                                                                                                 7
                                                                                                                                                                                                 1.4 文章结构
                                                                                                                                                                                                   验证结果预判方法等。并在最后通过一个简单例子来介绍完整验证流程。 3. 第四章 统计模型检测工具 SPAC
                                                                                                                                                                                                   SPAC(Statistical Probabilistic Approximate model Checker)是根据本文提出 方法相应实现的工具。该章节主要介绍 SPAC 的主要实现方法、框架结构、组成 模块、和验证的主要过程。
                                                                                                                                                                                                   4. 第五章 案例研究
                                                                                                                                                                                                   该章节主要对简单随机调度算法、同步领导者选举协议和 Herman 分布式算 法三个案例进行了研究。基于 SPAC,我们将本文提出的方法与 PRISM 中所实 现的 APMC(面向定量性质)、SPRT(面向定性性质)统计模型检测方法进行比 较。并评估了这三种方法在运行周期较长时、对可信度和精度要求较高时的表现。 5. 第六章 总结与展望
                                                                                                                                                                                                   该章节主要总结了本文研究工作的贡献与不足。并讨论了目前工作中可以改 进的地方与后续工作需要解决的问题。
                                                                                                                                                                                                   8
                                                                                                                                                                                                   第二章 背景知识
                                                                                                                                                                                                   2.1 模型定义与性质描述
                                                                                                                                                                                                     第二章 背景知识
                                                                                                                                                                                                     2.1 模型定义与性质描述
                                                                                                                                                                                                     2.1.1 离散时间马尔可夫链与概率迁移系统
                                                                                                                                                                                                     在本文中,验证的对象主要是针对随机离散事件系统(离散时间)。这类系 统的定义最先由 Younes 和 Simmons 给出[39]。因此可利用已广泛应用的离散时 间马尔可夫链来对这类系统进行建模。
                                                                                                                                                                                                       为形式化地对这类系统进行验证,先给出离散时间马尔可夫链模型的定义:
                                                                                                                                                                                                       定义 1. 离散时间马尔可夫链 离散时间马尔可夫链(discrete-time Markov chains,DTMC)是一个二元组(S, T),其中 S 是有限状态集,并且 T : S ¥ S Æ [0, 1] 是概率迁移函数,并对所有的状态s与其所有后继s'满足ÂT(s,s')=1。
                                                                                                                                                                                                       其次,离散时间马尔可夫链仅描述了状态与状态间的迁移关系。为了能够在 状态迁移过程中验证给定的性质,需要为马尔可夫链添加相应的标签功能。它将 马尔可夫链中的每个状态映射到一个原子命题集合(set of atomic propositions, AP)的子集。通俗来说,原子命题主要用来描述系统某个状态的“特质”。比如, 对于“终止”状态,则其所对应的原子命题集合可以是{terminate}。而对于“终止了 一次且正在运行”的状态,其状态可以是{terminate=1, running}。
                                                                                                                                                                                                       定义 2. 概率迁移系统 概率迁移系统(probabilistic transition system,PTS) 是一个四元组(S, T, s0, L)。其中,(S, T)是一个离散时间马尔可夫链,s0 Œ S 是 唯一的初始状态。而L:SÆ 2AP 是一个从状态到原子命题集的映射函数。
                                                                                                                                                                                                       2.1.2 事件的测度
                                                                                                                                                                                                       如果我们随机获得一条模型中的有限路径,则抽样到该条路径的概率是可测
                                                                                                                                                                                                       度的[40]。在[33]中已给出了完整的定义。在测度函数中,可以使用圆柱体集合 9
                                                                                                                                                                                                       第二章 背景知识 2.1 模型定义与性质描述
                                                                                                                                                                                                         (cylinder set)作为的基本事件。这里我们假定使用 Pr(event)表示事件 event 发 生的概率。
                                                                                                                                                                                                         2.1.3 概率计算树逻辑 PCTL
                                                                                                                                                                                                         这里主要通过概率计算树逻辑(probabilistic computation tree logic,PCTL) 来指定性质。它扩展了计算树逻辑 CTL,并加入了概率操作符 P(probabilistic operator)。其一般形式为:P~q (y),其中~ Œ{<,>,=,£,≥}、q Œ[0,1]。这里我们称 q 为概率阈值,并称y 为性质主体,它可以是 PCTL 状态公式或 PCTL 路径公式 [10]。其语法与语义已经在[10]中完整定义,故不再赘述。这里主要对 PCTL 表 示定量性质的语法进行扩展。
                                                                                                                                                                                                         为表示定量性质,在 PCTL 语法中,将概率阈值置换为未知量。它表示在算 法完成后,将直接返回性质主体被满足的概率。并表示本次验证是一次参数估计, 而非一次假设检验。定量形式定义如下:
                                                                                                                                                                                                         定义 3. 定量的 PCTL 形式 对于PCTL状态公式或路径公式y,P (y)表 ~?
                                                                                                                                                                                                         示性质的定量形式。它表示推断模型满足性质的概率。 接下去再定义定性性质的满足关系。
                                                                                                                                                                                                         假设 aŒ AP 是一个原子命题,PTS =(S, T, s0, L)是一个概率迁移系统, 且
                                                                                                                                                                                                         状态 sŒ S。f 和j 是 PCTL 状态公式且y i 是 PCTL 路径公式。并令 Path(s)表示所 有以状态 s 为初始状态的路径。另外,假设 p = s0 s1 s2 ... sk 是一条有限路径上 的状态序列。其中对于所有 i ≥ 0 ,有 T(si, si+1) > 0。并令 p[i]表示 p 的第 i+1 个状 态。
                                                                                                                                                                                                         这样对于状态 s 来说,状态相关的满足关系可以定义如下:
                                                                                                                                                                                                         定义 4. PCTL 主体和状态间的满足关系 对于状态 s,其满足关系定义如下: s |= a 当且仅当 aŒL(s)
                                                                                                                                                                                                         s|=¬f 当且仅当s不满足f
                                                                                                                                                                                                         s |=f Ÿj 当且仅当 s |=f且s |=j
                                                                                                                                                                                                         s|=P~θ(y)当且仅当{Pr(p|=y)~θ |pŒPath(s)} 而路径的满足关系可定义如下:
                                                                                                                                                                                                         10
                                                                                                                                                                                                         第二章 背景知识 2.2 贝叶斯推断
                                                                                                                                                                                                           定义 5. PCTL 主体与路径间的满足关系 对于路径 p,|p|为路径的长度,则 其满足关系定义如下:
                                                                                                                                                                                                           p |= Oy 当且仅当 p[1] |=y 且|p|≥1 £n
                                                                                                                                                                                                           p|=y1U y2 当且仅当存在i且0£i£n£| p|,满足p[i]|=y2并且对于所有 0£ j<i,有p[j]|=y1
                                                                                                                                                                                                             最后,我们可以定义概率迁移系统的满足关系如下。
                                                                                                                                                                                                             定义 6. PCTL 与 PTS 间的满足关系 对于概率迁移系统 PTS,其满足关系 定义如下:
                                                                                                                                                                                                             PTS |=P~θ(y)当且仅当Pr(p|=y )~θ且pŒPath(s0)
                                                                                                                                                                                                             它表示如果从初始状态 s0 开始的路径满足y 的概率符合~ θ 的要求,则概率 迁移模型PTS满足P~θ (y)。
                                                                                                                                                                                                             2.2 贝叶斯推断
                                                                                                                                                                                                             2.2.1 贝叶斯推断与先验信息
                                                                                                                                                                                                             贝叶斯统计学以 Thomas Bayes 命名,但是主要因为 Laplace 所发表的[42]而 发展。不同于其他统计推断方法,它将先验信息也作为推断的依据之一。在其他 推断方法中,主要会用到两种信息:
                                                                                                                                                                                                             ß 分布信息:它给出了未知参数所服从的总体分布信息,如果我们知道该 未知参数是满足正态分布或指数分布时,我们就能大概知道曲线的形状 等信息。比如在进行区间估计未知参数 r 时,通常会基于 r 所服从的分 布来给出对应的置信区间。
                                                                                                                                                                                                             ß 样本信息:它是最主要的信息来源。收集到的样本信息越多,做出的推 断往往更加精确。
                                                                                                                                                                                                             而贝叶斯推断还使用了第三种信息作为推断依据:
                                                                                                                                                                                                             ß 先验信息:在进行推断之前,我们常对于事件有着自己的认识。比如“抽
                                                                                                                                                                                                             得大奖”往往是个小概率事件,而“高峰期上班会堵车”是一个大概率事件。 这是我们不需要推断,就已经对事件的一个认识。而这部分认识,也能
                                                                                                                                                                                                             11
                                                                                                                                                                                                             第二章 背景知识 2.2 贝叶斯推断
                                                                                                                                                                                                               够作为一种推断的依据。
                                                                                                                                                                                                               在贝叶斯推断中,使用先验分布(prior distribution)来对先验信息进行描述。
                                                                                                                                                                                                               在进行取样之前,可以用一个概率分布去描述需要推断的参数。这个概率分布是 主观的,代表对于该参数的看法。
                                                                                                                                                                                                               比如,在一次考试中,平均分数高于 70 分。当我们想推断“任意同学考试分 数为 70 分”的概率时,则我们便可以使用一个期望值大于 70 的正态分布来作为 先验分布。而当对某个事件的发生概率没有任何先验经验时,我们可以使用一个 [a,b]间的均匀分布来描述先验经验。它表示其发生概率取[a,b]中任何值的机会都 是均等的,所以可能是[a,b]间的任意值。
                                                                                                                                                                                                               2.2.2 贝叶斯推断过程
                                                                                                                                                                                                                 下面我们通过一个例子,简单介绍贝叶斯推断的过程:
                                                                                                                                                                                                                 假设模型满足性质的概率为 r 。我们将其作为一个事件 X,再进行抽样观察。 假设我们抽样了 n 次,并且其中有 x 条路径是满足性质的。由于每条路径是否满 足性质是独立的,所以路径的满足条数服从二项分布。假设P(X = x | r)是对应 概率密度函数,则有:
                                                                                                                                                                                                                 Ênˆ x n-x P(X=x|r)=Áx ̃r (1-r)
                                                                                                                                                                                                                 它被称为似然函数,假设我们对模型满足性质概率一无所知,因此我们使用 [0,1]上的均匀分布作为先验分布来描述 r 。假设均匀分布的密度函数表示为 Un(0,1),则我们可以得到 X 与 r 的联合分布函数:
                                                                                                                                                                                                                 Ênˆ x n-x h(x,r)=P(X=x|r)¥Un(0,1)=Áx ̃r (1-r)
                                                                                                                                                                                                                 Ë ̄
                                                                                                                                                                                                                 (1)
                                                                                                                                                                                                                 ¥1 (2) 此时通过联合分布函数对 r 进行积分,我们可以得到边缘密度函数:
                                                                                                                                                                                                                 Ë ̄ 1Ênˆ x n-x
                                                                                                                                                                                                                 m(x)=ÚÁx ̃r (1-r) 0Ë  ̄
                                                                                                                                                                                                                 dρ (3) 这时我们既得到了联合分布,也得到了边缘分布。基于贝叶斯公式,我们就
                                                                                                                                                                                                                 能得到可用于做出推断的条件分布i(r | x): 12
                                                                                                                                                                                                                 (4)
                                                                                                                                                                                                                 我们将这个条件分布称为 r 的后验分布(posterior distribution)。它通过分布 函数来描述未知参数 r 。并且它包含了分布信息、样本信息和先验信息。当不断 获得新的样本时,后验分布会根据样本信息,对先验分布所提供的信息不断进行 调整。从而使得推断的结果更加趋近与于实际情况。所以,基于后验分布,我们 就能推断 r 的值。
                                                                                                                                                                                                                 2.2.3 共轭先验分布定理
                                                                                                                                                                                                                 可以指定不同分布作为先验分布。比如为了估计二项分布中的成功概率,常 采用贝塔分布作为先验分布。而推断泊松分布中的均值时,则常采用伽玛分布作 为其先验分布。不过研究随之发现,在某些情况下,先验函数与后验函数会同属 于一个分布族,这就是共轭先验分布。
                                                                                                                                                                                                                 举个例子,估计二项分布的成功概率 θ 时,如果将贝塔分布 Be (a , b ) 作为的 先验分布,其后验分布一定是贝塔分布 Be( a +x, b +n-x)。因此,贝塔分布被称 为是 θ 的共轭先验分布。由于通过先验分布和样本信息来计算后验分布时,往往 需要经过积分等复杂操作。而如果通过共轭先验分布理论,便可以直接得到后验 分布,简洁而快速。
                                                                                                                                                                                                                 2.3 本章小结
                                                                                                                                                                                                                 本章分别给出相关的模型指定方法PTS与性质描述方法PCTL,并简要介绍 了贝叶斯推断中先验信息、共轭先验分布等概念。因为后续所给出算法主要基于 本章所需要的基础知识。
                                                                                                                                                                                                                 2.3 本章小结
                                                                                                                                                                                                                   Ênˆ x n-x h(x,r) Áx ̃r (1-r)
                                                                                                                                                                                                                   i(r|x)= =Ë ̄
                                                                                                                                                                                                                   m(x) 1Ênˆ x n-x
                                                                                                                                                                                                                     ÚÁx ̃r (1-r) dρ 0Ë ̄
                                                                                                                                                                                                                     13
                                                                                                                                                                                                                     第三章 基于预测的贝叶斯统计模型检测方法 3.1 基本介绍
                                                                                                                                                                                                                       第三章 基于预测的贝叶斯统计模型检测方法
                                                                                                                                                                                                                       3.1 基本介绍
                                                                                                                                                                                                                       为了提高在高可信度与高精度要求下,对于随机系统的验证效率,本章提出 一种新的统计模型检测算法。它本质上结合了贝叶斯推断和蒙特卡洛方法:我们 会先对模型随机抽样有限路径作为样本,同时收集样本信息。然后通过贝叶斯推 断来给出结果。
                                                                                                                                                                                                                       对于 PTS P,可以从初始状态开始,不断根据迁移概率选择下一个状态,从 而随机获得一条有限路径 p。假设我们对于 P 验证 PCTL 性质 P ~θ (y ) 。则根据之 前定义的满足关系,有限路径 p 或满足y ,或不满足y 。由于每次所抽样的路径 是相互独立的,我们将一次路径的抽样与验证看成一次伯努利实验,并将验证结 果看作为一个样本。如果“ p 满足y ”,则表示本次实验“成功”。否则表示本次实 验“失败”。根据这些样本信息,我们使用后验分布来推断每次实验的成功概率, 即模型满足性质的概率。
                                                                                                                                                                                                                       与其他使用贝叶斯推断方法不同的是:在这些算法中,我们基于共轭先验分 布理论,引入了抽样数量预测和统计结果预测。这些预测机制可用于提高验证效 率,同时保证验证结果的可信度与精度。
                                                                                                                                                                                                                       另外,为了解决统计模型检测在长路径上验证性质效率下降的问题。我们重 新设计了路径抽样与验证部分:在对路径进行验证时,算法会去寻找可以直接判 断该路径是否满足给定性质的路径前缀。并将这些前缀收集起来。而在后续路径 抽样时,如果当前路径前缀与所收集的前缀相匹配,从而就能够直接预判该路径 的验证结果。这将会减少路径验证次数。
                                                                                                                                                                                                                       下面我们主要介绍三种算法:面向定性性质的验证算法、面向定量性质的验
                                                                                                                                                                                                                       14
                                                                                                                                                                                                                       第三章 基于预测的贝叶斯统计模型检测方法 3.2 面向定性性质的验证算法
                                                                                                                                                                                                                         证算法、启发式路径抽样与验证算法。其中前两种算法分别用于定性性质、定量 性质的验证。它们包含抽样数量预测和统计结果预测。第三种算法包含了路径验 证结果预测。它可以与前两种算法相结合,从而提高对运行周期较长系统的验证 效率。
                                                                                                                                                                                                                         3.2.1 方法框架
                                                                                                                                                                                                                         3.2 面向定性性质的验证算法
                                                                                                                                                                                                                          图 2 面向定性性质的验证算法框架
                                                                                                                                                                                                                          Fig.2 Framework of algorithm for verifying qualitative properties
                                                                                                                                                                                                                          本小节先介绍面向定性性质的检测算法。其主要流程如图 2 所示。与图 1 所 描述的两种框架不同,我们加入了抽样数量上限预测和统计结果预测。在图 2 中, 它们都用虚线框表示。
                                                                                                                                                                                                                          首先,除了完成建模与性质描述,还需要指定两个参数:可信度参数 c 和精 度参数d 。我们会根据 c 和d 给出所需样本数量的上限(见“预测抽样数量上限”
                                                                                                                                                                                                                          15
                                                                                                                                                                                                                          第三章 基于预测的贝叶斯统计模型检测方法 3.2 面向定性性质的验证算法
                                                                                                                                                                                                                            方框)。预测方法会在后续小节中详细介绍。
                                                                                                                                                                                                                            这里我们先介绍可信度参数 c、精度参数d 的作用:它们主要用来指定验证
                                                                                                                                                                                                                            结果的可信度与精度。假设模型实际满足给定性质的概率为 r ,后验函数的期望 值为 EX2。则我们要求 r 落入区间[EX2- d , EX2+ d ]的概率必须达到 c,即:
                                                                                                                                                                                                                            Pr(|r-EX2 |£d)≥c (5) 除此之外,对于性质 P~q (y ) ,其中~ Œ{ <, >, =, £, ≥ } 、q Œ [0, 1]。我们分别定
                                                                                                                                                                                                                            义两个假设:
                                                                                                                                                                                                                            ß 原假设:模型满足性质的概率是符合~q的。
                                                                                                                                                                                                                            ß 备选假设:模型满足性质的概率是不符合~q的。 而在下面的步骤中,我们会根据贝叶斯推断的结果来选择其中一个假设。这
                                                                                                                                                                                                                            便是一次假设检验。
                                                                                                                                                                                                                            其次,我们开始对 PTS 随机抽取有限随机路径,并对每条路径进行验证(见
                                                                                                                                                                                                                            “抽样单条路径”和“验证单条路径”方框)。在“抽样-验证”过程中,我们记录下目 前抽样路径总数 n 与满足性质的路径条数 x。由于有限路径是随机抽取的,它们 的验证结果相互独立。所以我们可以把这个过程看成是多次伯努利实验。如果路 径满足性质,则表示本次实验“成功”,反之则表示“不成功”。
                                                                                                                                                                                                                            而对于该伯努利实验,我们并不知道实验的成功概率(即模型满足性质的概 率)是多少。但是我们可以基于之前的统计数据,使用贝叶斯推断来对这个值进 行推断。
                                                                                                                                                                                                                            我们采用了序贯抽样方案:通常在完成一次伯努利实验后,都会使用贝叶斯 推断来计算当前推断结果的可信度与精度(见“计算可信度”方框)。如果可信度 与精度达到了 c 和d 的要求(公式(5)),则立即停止抽样并返回结果。而如果没 有达到要求,则继续进行伯努利实验直到达到可信度要求或达到抽样上限。此时 一次假设检验结束。
                                                                                                                                                                                                                            但是我们对这个方案进行了改进:每次在使用贝叶斯推断计算结果可信度、 精度前,我们会先使用后续小节中所介绍的方法来预测统计结果,并保证预测结 果的可信度与精度(见“预测统计结果”方框)。这样就能尽早地结束“抽样-验证”
                                                                                                                                                                                                                            16
                                                                                                                                                                                                                            第三章 基于预测的贝叶斯统计模型检测方法 3.2 面向定性性质的验证算法
                                                                                                                                                                                                                              流程,减少实验次数。 下面首先我们会先分别介绍抽样数量预测方法、统计结果预测方法和结果可
                                                                                                                                                                                                                              信度计算方法。然后再给出完整的算法描述。
                                                                                                                                                                                                                              3.2.2 抽样数量上限预测方法
                                                                                                                                                                                                                              在贝叶斯推断中,需要先指定先验分布,并通过不断收集样本信息对先验分 布进行调整,从而得到相应的后验分布。然而在一些情形,先验分布在经过调整 后,所得到的后验分布依然是与先验分布属于同一个分布族,甚至是同一种分布。
                                                                                                                                                                                                                              共轭先验分布理论对这类现象进行了总结,并给出了一系列存在这种关系的 先验分布与后验分布[35]。基于共轭先验分布理论,我们能够通过统计信息和先 验分布参数直接计算得到后验分布,这也是我们选择贝叶斯推断的重要原因之一。
                                                                                                                                                                                                                              举个例子,假设我们想推断伯努利实验每次实验的成功概率。我们将先验分 布指定为贝塔分布 Be (a , b ) (其中 a 和 b 都被称为形状参数),并记录下实验次 数 n 与实验成功的次数 x。根据共轭先验分布理论,我们就能直接得到后验分布 为 Be( a +x, b +n-x),而不需要其他复杂计算。
                                                                                                                                                                                                                              这为预测抽样数量上界提供了基础。通过共轭先验分布理论,我们能够尝试 带入不同的统计值(如 n 与 x)来计算后验分布的期望值与方差。进一步地,通 过结合切比雪夫不等式,我们就能够建立起抽样数量与可信度参数、精度参数之 间的桥梁,从而根据这两个参数预测出抽样数量上限。
                                                                                                                                                                                                                              另外,在估计伯努利实验中的成功概率 r 时,较多会采用贝塔分布 Be (a , b ) 作为先验分布。因为一方面在共轭先验分布理论中已给出:在对伯努利实验中实 验成功概率 r 进行估计时,贝塔分布是 r 的共轭先验分布。而且贝塔分布可以用 于拟合多种类型的分布曲线。所以,本文也主要使用贝塔分布作为先验分布。
                                                                                                                                                                                                                                下面先给出预测方法,再对方法中的公式进行证明。
                                                                                                                                                                                                                                定理 1. 给定可信度参数 c、精度参数d 和先验分布 Be(a , b ),如果 n 使得 公式(6)中的等号成立。则进行 n 次试验后,推断结果肯定满足(5)。
                                                                                                                                                                                                                                [a + (b - a + n) / 2][b + n - (b - a + n) / 2] £ (1 - c)d 2
                                                                                                                                                                                                                                ( n + a + b ) 2 ( n + a + b + 1) ( 6 )
                                                                                                                                                                                                                                 17
                                                                                                                                                                                                                                 第三章 基于预测的贝叶斯统计模型检测方法 3.2 面向定性性质的验证算法
                                                                                                                                                                                                                                   证明:假设可信度参数 c、精度参数d 已经给定。并指定先验分布为 Be(a , b )。
                                                                                                                                                                                                                                   根据共轭先验分布理论,可直接推得后验分布为 Be (a + x, b + n - x) ,其中 n 是实验次数、x 是成功实验次数。因此,后验分布的形状参数分别为a +x 和 b +n-x。
                                                                                                                                                                                                                                   而贝塔分布可以直接根据形状参数计算其期望值与方差。所以通过公式 (7)(8),我们就可以得到后验分布的期望值 EX2、方差 VAR2。
                                                                                                                                                                                                                                   Pr(|r-EX2 |£d)≥1-VAR2 (9) δ2
                                                                                                                                                                                                                                   结合我们对验证结果的要求(公式(5))。只需要公式(9)的右边部分大于 c 时, 就能够满足可信度与精度的要求。并且当d 已给定时,公式(9)右边部分的大小仅 取决于 VAR2。而 VAR2 的值是可由公式(8)计算得到。这样就建立了d 、c 与抽样 数量之间的联系。
                                                                                                                                                                                                                                   但是依然存在的问题是:实验成功次数 x 只能在抽样完成后才能获得。因此, 需要在这个关系式中去掉 x,才能够通过a 、b 、d 、c 来计算 n。假设公式(2) 中,VAR2 的a 、 b 和 n 是固定的。则通过求一阶与二阶导,很容易推出:当 x =( b -a +n)/2 时,VAR2 可以取到最大值 VAR2MAX。
                                                                                                                                                                                                                                   由于VAR2取到最大值时,公式(4)的右边1- VAR2 取到最小值。即: δ2
                                                                                                                                                                                                                                   Pr(|r-EX2 |£d)≥1-VAR2 ≥1-VAR2MAX (10) d2 d2
                                                                                                                                                                                                                                   因此,当不等式的最右式等于c时,则r落入区间[EX2-d ,EX2+d ]的概率肯 定大于等于 c。即达到了可信度与精度的要求。因此,将 VAR2MAX 展开并整理得 以下不等式:
                                                                                                                                                                                                                                   EX2(a,b,x,n)= a+x a+b+n
                                                                                                                                                                                                                                   (7) 2 (a + b + n) 2 (a + b + n + 1) (8)
                                                                                                                                                                                                                                    VAR (a,b,x,n)= (a+x)(b+n-x) 根据切比雪夫公式,我们可以知道 EX2 与 VAR2 满足公式(9)。
                                                                                                                                                                                                                                         18
                                                                                                                                                                                                                                         第三章 基于预测的贝叶斯统计模型检测方法 3.2 面向定性性质的验证算法 VAR = [a +(b -a +n)/2][b +n-(b -a +n)/2] £ (1-c)d2
                                                                                                                                                                                                                                         2MAX (n+a +b)2(n+a +b +1) (11)
                                                                                                                                                                                                                                         通过(11)可以发现,当 n 上升时,VAR2MAX 是单调递减的。因此,当 n 足够 大时,VAR2MAX 就足够小,并且满足(5)。通俗来说,即抽样数量足够大时,后验 分布方差就会收敛得足够小,并使得结果满足可信度与精度的要求。所以此时的 n 使得公式(11)中的等号成立时,结果是可信赖的。
                                                                                                                                                                                                                                         然而,当等号成立时,这个等式较难整理出可以直接计算 n 最大值的函数。 但是,可以利用一个简单二分法算法,通过查找就能解出 n 的最大值。并且该算 法的时间复杂度只需 O(logn),具体算法请见附录。
                                                                                                                                                                                                                                         所以,通过公式(11),我们就能够根据先验分布参数、可信度参数和精度参 数直接预测抽样数量上限(即实验次数上限)。并保证当所收集的样本数量达到 该上限时,结果的可信度与精度都满足所给定的要求。
                                                                                                                                                                                                                                         3.2.3 面向定性性质的统计结果预测方法
                                                                                                                                                                                                                                         假设我们期望验证性质P~θ(y),而实际模型满足性质的概率为r。当|r-q | 越小,所需的样本数量就越多[39]。因为这时需要更多的样本来分辨 r 与q 之间 的大小。在实际验证过程中,我们并不知道| r -q |的大小。但是当r 属于区间[q -d ,q+d ]时,后验分布期望值EX2会逐渐靠近r。然而,即使抽样数量达到所计 算的上限,也只能保证结果是满足公式(5)。这不足以分辨 r 与q 之间的大小。
                                                                                                                                                                                                                                         所以,当抽样数量达到上限时,并且q 落入区间[EX2-d ,EX2+d ](EX2 为后 验分布的期望值),我们推断 r 与q 是相等的。不过,我们尝试在抽样数量达到上 限前,提前预判q是否最终会落入区间[EX2-d ,EX2+d ],从而减少抽样数量,提 高验证效率。这也是统计结果预测的主要目的。
                                                                                                                                                                                                                                         预判主要基于两部分内容:(1)后验分布的期望值调整幅度会随着实验次数 增加而减少。(2)前一小节所介绍的抽样数量上限。这里会先介绍(1),然后再与(2) 联系起来给出具体预测方法。
                                                                                                                                                                                                                                         由于我们主要采用贝塔分布作为先验分布,因此分析主要针对贝塔分布作为 先验分布的情况。
                                                                                                                                                                                                                                            19
                                                                                                                                                                                                                                            第三章 基于预测的贝叶斯统计模型检测方法 3.2 面向定性性质的验证算法
                                                                                                                                                                                                                                              假设我们将 Be (a , b ) 作为先验分布,并且我们做了 n 次实验,并成功了 x1 次。这时我们能够根据公式(11)来计算后验分布的期望值。但是我们不观察具体 期望值数值,而是观察:在 n 为不同值时,每次实验结果对于后验分布的期望值 影响有多大。假设我们又做了一次实验。目前的实验次数为 n+1、实验成功次数 为 x2。所以有:
                                                                                                                                                                                                                                              a+x2 - a+x1 = (x2 -x1)(a+b+n)-(a+x1) a+b+n+1 a+b+n (a+b+n+1)(a+b+n)
                                                                                                                                                                                                                                              (12)
                                                                                                                                                                                                                                                     很明显,在 n 不断变大时,等式(12)的右式是会不断变小的。这与 Chernoff 界的结论基本是一致的。所以,在实验次数 n 已经非常大时,实验结果对与后验 分布期望值的影响非常有限。在对精度要求不是非常高的要求下,这么多实验次 数会反而会使得推断过程变得低效。
                                                                                                                                                                                                                                                     但是,如果我们知道接下去的实验会对后验分布期望值只做非常小、乃至可 以忽略不计的调整时,我们就可以停止实验,直接返回结果。由于我们在前一小 节中,给出了抽样数量上限。所以我们最多实验次数也就达到抽样数量上限。因 此根据目前的实验次数 n,实验成功次数 x,我们可以预测后验分布期望值的变 化范围。
                                                                                                                                                                                                                                                     根据公式(12):当某次实验失败时,后验分布的期望值会相应减小,反之相 应变大。所以,如果我们分别假设在达到抽样数量上限前,接下去所有的实验都 是成功的(或是失败的),这样就能得到:
                                                                                                                                                                                                                                                     ß 所有后续实验全部失败时的后验分布期望值EX21。
                                                                                                                                                                                                                                                     ß 所有后续实验全部成功时的后验分布期望值EX22。 因此,期望值可能的最大调整范围为[EX21, EX22]。举个例子,假设我计算得
                                                                                                                                                                                                                                                     到抽样数量上限为 n0,而当前抽样次数为 n。则后验期望在做完 n0 次试验后, EX2 必定属于[EX21, EX22]区间。同时,结果的可信度与精度都由定理 1 保证。而 此时q仍然同时属于区间[EX21-d ,EX21+d ]和[EX22-d ,EX22+d ]的话,则说明即 使在达到抽样上限后,依然不能够分辨 r 与q 之间的大小。所以我们便可以直接 推断 r 与q 是相等的,从而避免剩余的抽样过程。其具体算法如下:
                                                                                                                                                                                                                                                     20
                                                                                                                                                                                                                                                     第三章 基于预测的贝叶斯统计模型检测方法 3.2 面向定性性质的验证算法
                                                                                                                                                                                                                                                            算法 1.统计结果预测算法 predictQualitativeStatistic(面向定性性质) 输入:精度参数d, 抽样数量上限n0, 实验总数n, 实验成功次数x, a,
                                                                                                                                                                                                                                                            b
                                                                                                                                                                                                                                                            输出:统计结果是否已经满足要求
                                                                                                                                                                                                                                                            EX21 = formula(7) (a ,b ,n0,x+(n0-n))
                                                                                                                                                                                                                                                            EX22 = formula(7) (a ,b ,n0,x)
                                                                                                                                                                                                                                                            if q in [EX21-d , EX21+d ] and [EX22-d , EX22+d ] then
                                                                                                                                                                                                                                                                return True else
                                                                                                                                                                                                                                                                return False end if
                                                                                                                                                                                                                                                                   首先,我们假设后续的实验全部成功或者失败,并计算相应的后验分布期望 值 EX21 和 EX22。通过将它们与q 所比较,我们就能得知接下去的实验相对目前 的结果是否会有所改变。当 EX21 和 EX22 所可能的移动范围小于精度参数d 时, 算法便返回 True,表示结果不会改变。否则返回 False。
                                                                                                                                                                                                                                                                   综上所述,如果在一次实验完成后,调用 predictQualitativeStatistic,我们就 能预判统计结果是否还会发生改变。这样就能避免做大量实验来对后验分布期望 值做可忽略不计的调整,并最终做出相同的推断。
                                                                                                                                                                                                                                                                   3.2.4 结果可信度计算方法
                                                                                                                                                                                                                                                                   由于采用了序贯抽样方案。因此,在每次路径抽样与验证后,需要根据目前 的统计结果重新计算当前结果的可信度。
                                                                                                                                                                                                                                                                   我们根据后验分布的分位数来计算可信度[27]。假设我们对性质P~θ (y)进行 验证。根据可信度参数 c,我们分别计算后验分布的 c 分位数和 1-c 分位数。并 将它们与q 进行比较。由于已经预测得到后验分布,则我们就能够利用各类数学 库函数(如 Scipy 数学库的 ppf 函数)来得到其 c 和 1-c 分位的分位数。
                                                                                                                                                                                                                                                                   如果 c 分位数小于概率阈值或 1-c 分位数大于概率阈值。则说明结果满足以 21
                                                                                                                                                                                                                                                                   第三章 基于预测的贝叶斯统计模型检测方法 3.2 面向定性性质的验证算法
                                                                                                                                                                                                                                                                     下不等式:
                                                                                                                                                                                                                                                                     Pr( r £ q ) ≥ c 或 Pr( r ≥ q ) ≥ c
                                                                                                                                                                                                                                                                     这就有足够的把握推断 r £ q 或 r ≥ q ,并给出相应的结论。因此,可信度计
                                                                                                                                                                                                                                                                     算算法如下:
                                                                                                                                                                                                                                                                     (13)
                                                                                                                                                                                                                                                                          算法 2. 结果可信度计算算法 calculateConfidence
                                                                                                                                                                                                                                                                          输入:概率阈值q , 可信度参数 c, 实验总数 n, 实验成功次数 x, a , b 输出:如果可信度满足(5)的要求,则返回 True。否则返回 False。 low = Beta.quantile(a +x, b +n-x, c) //获得 c 分位数
                                                                                                                                                                                                                                                                          high = Beta.quantile(a +x, b +n-x, 1-c) //获得 1-c 分位数
                                                                                                                                                                                                                                                                          if high£ q || low≥ q then
                                                                                                                                                                                                                                                                              return True //结果可信度满足要求 else
                                                                                                                                                                                                                                                                              return False //尚未达到可信度要求 end if
                                                                                                                                                                                                                                                                                 3.2.5 算法描述
                                                                                                                                                                                                                                                                                 本节给出面向定性性质的完整算法描述,见算法 3。 第一步,根据(11)中的方法预测抽样数量上限。之后开始抽样有限路径。 第二步,算法会从 PTS 模型中,随机抽样一条长度为 k 的路径,随后对该路
                                                                                                                                                                                                                                                                                 径进行验证。根据验证的结果,算法会分别统计总抽样数 n 与满足性质的路径条 数x。
                                                                                                                                                                                                                                                                                 第三步,根据算法 1 预测统计结果。如果预测成功,则直接跳到第六步,否 则回到第二步。
                                                                                                                                                                                                                                                                                 第四步,根据算法 2 计算当前结果可信度。如果当前结果可信度已经达到要
                                                                                                                                                                                                                                                                                 求,则直接跳到第五步,否则回到第二步。
                                                                                                                                                                                                                                                                                 22
                                                                                                                                                                                                                                                                                 第三章 基于预测的贝叶斯统计模型检测方法 3.2 面向定性性质的验证算法
                                                                                                                                                                                                                                                                                   第五步,根据后验分布来做出推断:如果后验分布 1-c 分位数小于概率阈值, 则推断模型满足性质的概率小于(或小于等于)概率阈值。同样,如果后验分布 c 分为数大于概率阈值,则推断模型满足性质的概率大于(或大于等于)概率阈 值。
                                                                                                                                                                                                                                                                                   第六步,只有当抽样数量达到上限或者预测统计结果不会改变,才会来到这 一步。而这两种情况都说明模型满足性质的概率非常接近概率阈值。因此推断模 型满足性质的概率等于概率阈值。
                                                                                                                                                                                                                                                                                        算法 3. 基于预测的贝叶斯统计模型检测算法 PBMC(面向定性性质) 输入:模型PTS, 性质主体ψ, 精度参数d ,概率阈值q, 可信度参数c, 路 径长度k, a, b
                                                                                                                                                                                                                                                                                        输出:模型 PTS 是否满足 P~q (y )
                                                                                                                                                                                                                                                                                        n0 = getMaxSampleSize(d , c, a , b ) //预测抽样数量上限 x = 0 //实验成功次数
                                                                                                                                                                                                                                                                                        for i = 0 to n0 do
                                                                                                                                                                                                                                                                                            p = generate a random path of PTS with length k n = n+1 //实验总次数
                                                                                                                                                                                                                                                                                            if p |=ψ then //路径满足给定性质
                                                                                                                                                                                                                                                                                                x = x+1
                                                                                                                                                                                                                                                                                                end if
                                                                                                                                                                                                                                                                                                if predictQualitativeStatistic(d , n0, n, x, a , b ) then
                                                                                                                                                                                                                                                                                                    return //直接返回预测结果 end if
                                                                                                                                                                                                                                                                                                    EX2 = formula(7)(a , b , n, x) //根据公式(7)计算后验期望
                                                                                                                                                                                                                                                                                                    con = calculateConfidence(q , c, n, x, a , b ) //算法 2 计算 可信度
                                                                                                                                                                                                                                                                                                    if con >= c and EX2 ~ q then
                                                                                                                                                                                                                                                                                                           23
                                                                                                                                                                                                                                                                                                           第三章 基于预测的贝叶斯统计模型检测方法 3.3 面向定量性质的检测算法
                                                                                                                                                                                                                                                                                                                  return PTS 满足性质 else
                                                                                                                                                                                                                                                                                                                  return PTS 不满足性质 end if
                                                                                                                                                                                                                                                                                                                  end for if~Œ{=,£,≥} then
                                                                                                                                                                                                                                                                                                                  return PTS 满足性质 else
                                                                                                                                                                                                                                                                                                                  return PTS 不满足性质 end if
                                                                                                                                                                                                                                                                                                                     3.3.1 方法框架
                                                                                                                                                                                                                                                                                                                     3.3 面向定量性质的检测算法
                                                                                                                                                                                                                                                                                                                     面向定量性质的算法与上一小节面向定性性质的算法基本相似(见图 3)。 主要不同的地方主要有两点:
                                                                                                                                                                                                                                                                                                                     ß 这是一次参数估计,最终目的是估计模型满足性质的概率。
                                                                                                                                                                                                                                                                                                                     ß 统计结果预测算法会预测后验分布分位数的最大移动范围,并将其与性
                                                                                                                                                                                                                                                                                                                     质中的概率阈值相比较。
                                                                                                                                                                                                                                                                                                                     3.3.2 面向定量性质的统计结果预测方法
                                                                                                                                                                                                                                                                                                                     举个例子,假设我们尝试验证性质 P~q (y ) ,并且将可信度参数、精度参数分 别指定为 0.01、0.01。在每次统计数据更新后,假设剩余的实验全部成功或者失 败,根据公式(7),可以得到相应的后验分布期望值。假设实验全部失败时的后验 期望值为 EX2Fail,基于当前后验分布的期望 EX2。可以根据以下情况对统计结果 进行预判:
                                                                                                                                                                                                                                                                                                                     ß 如果后续实验全部失败且EX2-EX2Fail£d,则说明达到抽样数量上限后, 24
                                                                                                                                                                                                                                                                                                                     第三章 基于预测的贝叶斯统计模型检测方法 3.3 面向定量性质的检测算法
                                                                                                                                                                                                                                                                                                                       后验分布期望值的调整已经可以忽略不计。因此直接以 EX2 作为估计。
                                                                                                                                                                                                                                                                                                                       ß 如果后续实验全部失败且 EX2-EX2Fail>d ,则说明后验分布依然可能做
                                                                                                                                                                                                                                                                                                                         有意义的调整,因此无法预测。
                                                                                                                                                                                                                                                                                                                         ß 如果后续实验全部成功且 EX2Succeed-EX2 £ d ,则说明达到抽样数量上限
                                                                                                                                                                                                                                                                                                                         后,后验分布期望值的调整已经可以忽略不计。因此直接以 EX2 作为估
                                                                                                                                                                                                                                                                                                                         计。
                                                                                                                                                                                                                                                                                                                         ß 如果后续实验全部成功且 EX2Succeed-EX2>d ,则说明后验分布依然可能
                                                                                                                                                                                                                                                                                                                           做有意义的调整,因此无法预测。
                                                                                                                                                                                                                                                                                                                           综上所述,具体的统计结果预测算法如下:
                                                                                                                                                                                                                                                                                                                           图 3 面向定量性质的验证算法框架
                                                                                                                                                                                                                                                                                                                           Fig.3 Framework of algorithm for verifying quantitative properties
                                                                                                                                                                                                                                                                                                                                 算法 4.统计结果预测算法 predictQuantitativeStatistic(面向定量性质)
                                                                                                                                                                                                                                                                                                                                    25
                                                                                                                                                                                                                                                                                                                                    第三章 基于预测的贝叶斯统计模型检测方法 3.3 面向定量性质的检测算法
                                                                                                                                                                                                                                                                                                                                           输入:精度参数 d , 抽样数量上限 n0, 当前实验次数 n, 实验成功次数 x, 当 前后验分布期望值EX2, a, b
                                                                                                                                                                                                                                                                                                                                           输出:如果估计结果不再变化,则返回 True,否则返回 False EX2_all_left_succeeded = formula(7)(a , b , n0, x+(n0-n)) EX2_all_left_failed = formula(7)(a , b , n0, x)
                                                                                                                                                                                                                                                                                                                                           if EX2_all_left_succeeded-EX2 £ d then return True //结果不会再变化
                                                                                                                                                                                                                                                                                                                                               else if EX2-EX2_all_left_succeeded £ d then return True //结果不会再变化
                                                                                                                                                                                                                                                                                                                                                   else
                                                                                                                                                                                                                                                                                                                                                          return False
                                                                                                                                                                                                                                                                                                                                                          end if
                                                                                                                                                                                                                                                                                                                                                             3.3.3 算法描述
                                                                                                                                                                                                                                                                                                                                                             在开始介绍算法前,我们需要先做一些准备工作。首先,我们假设已经完成 模型构建和性质描述,得到模型 PTS 和性质ψ 。其次,我们还需要指定可信度参 数 c、精度参数d 和抽样路径长度 k。最后,如果对于系统具有先验信息,可以 根据对应的分布曲线来指定a 、b 。如果对于所验证的系统毫无经验,则可以将 a 、 b 都指定为 1。这时,贝塔分布函数的曲线近似于[0,1]上的均匀分布曲线。 也就是说明我们对模型满足性质的概率毫不知情,它取[0,1]中的任何值,都是等 概率的。
                                                                                                                                                                                                                                                                                                                                                             具体算法见算法 5:
                                                                                                                                                                                                                                                                                                                                                             首先,算法会根据附录的算法预测抽样数量上限。然后进入循环,不断从模 型中随机抽取有限路径,并对它进行验证。如果满足,则对满足的路径条数 x 加 1。并记录总抽样条数 n。
                                                                                                                                                                                                                                                                                                                                                             其次,在 n 和 x 更新后,算法会根据算法 4 来预测统计结果,如果预测结果 成功,则直接退出循环,并返回当前后验分布期望值的包围区间。如果预测失败,
                                                                                                                                                                                                                                                                                                                                                             26
                                                                                                                                                                                                                                                                                                                                                             第三章 基于预测的贝叶斯统计模型检测方法 3.3 面向定量性质的检测算法
                                                                                                                                                                                                                                                                                                                                                               则进入下一步。
                                                                                                                                                                                                                                                                                                                                                               最后,在统计结果预测失败后,算法会根据算法 2 计算当前结果的可信度。
                                                                                                                                                                                                                                                                                                                                                               如果结果的可信度已经达到(5)的要求。则最终返回这个区间作为估计。如果失败, 则回到第一步继续进行下一次循环。
                                                                                                                                                                                                                                                                                                                                                                    算法 5. 基于预测的贝叶斯统计模型检测算法 PBMC(面向定量性质) 输入:模型PTS,性质主体ψ,精度参数d,可信度参数c,路径长度k, a,
                                                                                                                                                                                                                                                                                                                                                                    b
                                                                                                                                                                                                                                                                                                                                                                    输出:PTS 满足 P~q (y ) 的概率
                                                                                                                                                                                                                                                                                                                                                                    n0 = getMaxSampleSize(d , c, a , b ) //预测抽样数量上限 x =0
                                                                                                                                                                                                                                                                                                                                                                    for i = 0 to n0 do
                                                                                                                                                                                                                                                                                                                                                                        p = generate a random path of PTS with length k n = n+1
                                                                                                                                                                                                                                                                                                                                                                        if p |= ψ then
                                                                                                                                                                                                                                                                                                                                                                            x = x+1
                                                                                                                                                                                                                                                                                                                                                                            end if
                                                                                                                                                                                                                                                                                                                                                                            if predictQuantitativeStatstic(d ,n0, n, x, EX2, a )
                                                                                                                                                                                                                                                                                                                                                                                break end if
                                                                                                                                                                                                                                                                                                                                                                                end for
                                                                                                                                                                                                                                                                                                                                                                                EX2 = Formula(7)(a ,b , n, x)
                                                                                                                                                                                                                                                                                                                                                                                low = EX2-d
                                                                                                                                                                                                                                                                                                                                                                                high = EX2+d
                                                                                                                                                                                                                                                                                                                                                                                if EX2-d < 0 then low = 0 end if if EX2+d > 1 then high = 1 end if return [low, high]
                                                                                                                                                                                                                                                                                                                                                                                    //公式(7)计算后验期望
                                                                                                                                                                                                                                                                                                                                                                                       27
                                                                                                                                                                                                                                                                                                                                                                                       第三章 基于预测的贝叶斯统计模型检测方法 3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                         3.4.1 方法框架
                                                                                                                                                                                                                                                                                                                                                                                         3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                          图 4 启发式抽样与验证算法框架
                                                                                                                                                                                                                                                                                                                                                                                          Fig.4 Framework of heuristic sampling and verifying algorithm
                                                                                                                                                                                                                                                                                                                                                                                          在本节中,我们主要介绍启发式路径抽样与验证算法。不同于相关研究一节 中介绍的的若干种方法。该方法主要重新设计了路径抽样与路径验证算法,与具 体所采用的统计学方法无关。因此,它可以与其他统计模型检测算法结合来进行 验证。
                                                                                                                                                                                                                                                                                                                                                                                          28
                                                                                                                                                                                                                                                                                                                                                                                          第三章 基于预测的贝叶斯统计模型检测方法 3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                            如前文所述,无论对于面向定量或定性的算法,由于我们都将每次路径抽样 验证看作伯努利实验中的一次实验。因此,在每次抽样到有限路径后,需要验证 路径来确定本次实验是否“成功”。然而如果对运行周期更长的系统验证性质,则 需要验证更长的路径。根据前文分析,当抽样路径长度增长 1 时,则算法复杂度 会对应地增长n¥|y |。因此,路径验证次数与路径抽样次数都是影响模型统计效 率的主要因素之一。
                                                                                                                                                                                                                                                                                                                                                                                            我们考虑将路径抽样与验证分开为两个步骤。并利用验证时所收集的信息来 帮助后续抽样进行预判。结合前两节中介绍的两种算法,其主要方法框架如图 4 所示。
                                                                                                                                                                                                                                                                                                                                                                                            图 5 使用硬币模仿骰子的马尔可夫链
                                                                                                                                                                                                                                                                                                                                                                                            Fig.5 Markov chain for simulating a die by a fair coin.
                                                                                                                                                                                                                                                                                                                                                                                            3.4.2 一个基本观察
                                                                                                                                                                                                                                                                                                                                                                                            观察图 5,这是经典的用公平硬币来模仿六面骰子的过程,它最初由 Knuth
                                                                                                                                                                                                                                                                                                                                                                                            和 Yao 提出[43]。这是一个离散时间的马尔可夫链。它的初始状态为 s0,表示还 29
                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                                                                                             第三章 基于预测的贝叶斯统计模型检测方法 3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                               未开始掷硬币。每条出边表示当硬币为正面或反面时,所迁移往的状态。并且硬 币为正面与为反面的概率相等,都是 50%。而最底下的圆形状态表示根据硬币投 掷情况所映射到的骰子数字。并且都指向自己,属于吸收状态(absorbing state)[33]。 值得注意的是,在 s’1,2,3 和 s’4,5,6 分别有指向 s1,2,3 和 s4,5,6 的回边。它表示根据目 前所掷的硬币的情况,映射到了一个‘空’的位置。因此需要重新抛掷硬币来决 定。
                                                                                                                                                                                                                                                                                                                                                                                               这里给出模型定义,对于第三层节点,我们使用最终可能映射到的骰子数字 作为每个状态映射到的原子命题。
                                                                                                                                                                                                                                                                                                                                                                                               ß S = {s0, s1,2,3, s’1,2,3, s2,3, s4,5,6, s’4,5,6, s4,5, s1, s2, s3, s4, s5, s6}
                                                                                                                                                                                                                                                                                                                                                                                               ß T = {(s0, s1,2,3), (s0, s4,5,6), (s1,2,3, s’1,2,3), (s1,2,3, s2,3), (s2,3, s2), (s2,3, s3) , (s’1,2,3, s1), (s’1,2,3, s1,2,3) (s4,5,6, s4,5), (s4,5,6, s’4,5,6), (s4,5, s4), (s4,5, s5), (s’4,5,6, s6), (s’4,5,6,
                                                                                                                                                                                                                                                                                                                                                                                               s4,5,6) }
                                                                                                                                                                                                                                                                                                                                                                                               ß S0={s0}
                                                                                                                                                                                                                                                                                                                                                                                               ß L = {<s0, {true}>, < s1,2,3, {true}>, <s4,5,6, {true}>, < s’1,2,3, {true}>, <s2,3, {true, s2, s3}>, < s4,5, {true, s4, s5}>, < s’4,5,6, {true}>, < s1, {true, s1}>, < s2, {true, s2}>, < s3, {true, s3}>, < s4, {true, s4}>, < s5, {true, s5}>, < s6, {true, s6}>
                                                                                                                                                                                                                                                                                                                                                                                               假设我们现在要验证性质“在三次投掷次数内,最终所映射的数字是 2 或者 3 的概率大于 40%”。该性质使用 PCTL 可定义为:
                                                                                                                                                                                                                                                                                                                                                                                               Pθ>0.4 (trueU£3 (s2 ⁄s3)) (14) 显然,模型不满足性质(14),最终所映射的数字是 2 或者 3 的概率肯定小于 40%。但是我们依然按照一般统计模型检测的方法来尝试验证。假设抽取的有限
                                                                                                                                                                                                                                                                                                                                                                                               路径长度为 3。假设第一次抽样到的路径为 p1 = <s0, s1,2,3, s2,3, s2>。则经过验证, 路径 p1 是符合性质的。所以目前抽样总数 n = 1 且满足的路径数 x = 1。假设抽样 第二条路径 p2 时,第二条路径 p2 的前三个状态依然是<s0, s1,2,3, s2,3>。通过观察 我们可以发现:如果继续随机选择状态,则必定会迁移到状态 s2 或 s3。因此,并 不需要知道下一个状态,就已经可以断定:p2 满足性质(14)。
                                                                                                                                                                                                                                                                                                                                                                                               3.4.3 最短可判前缀
                                                                                                                                                                                                                                                                                                                                                                                               30
                                                                                                                                                                                                                                                                                                                                                                                               第三章 基于预测的贝叶斯统计模型检测方法 3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                                 基于上面的观察,我们考虑通过在验证的过程中保存路径的前缀。使得在下 次再次随机抽样到该路径前缀时,能够马上做出判断。
                                                                                                                                                                                                                                                                                                                                                                                                 然而,主要问题是:如何找出最短的路径前缀?举个例子,在对路径 p3 = <s0, s1,2,3, s2,3, s2>进行验证时,前文已提到,在状态 s2,3 时,我们已经可以判定该条路 径满足性质。而其实在状态 s2 或 s3 时,我们也可以判定该路径满足性质。因此, 一条路径上可能存在多个可以进行判定的前缀。但状态 s2,3 时,我们可以相比其 他两个状态,更早地确定该路径满足性质(14),且省去了一部分的抽样过程。
                                                                                                                                                                                                                                                                                                                                                                                                 进一步地,需要验证的性质往往包括子性质。而如果要找出满足上层性质的 “最短可判前缀”,则需要预先知道子性质的“最短可判前缀”。因此,整个过程 是递归的,这与经典的 CTL 验证算法类似。所以我们考虑在对路径验证的同时, 来收集关于“最短可判前缀”的信息。另外我们假定“关键状态”表示“最短可 判前缀”中的最后一个状态。并且,由于“关键状态”的位置,决定了“最短可 判前缀”的长度。因此,我们将问题转化为寻找“关键状态”。
                                                                                                                                                                                                                                                                                                                                                                                                 为形式化地解决这个问题,先给出路径 p 中状态 s 对于 PCTL 性质中的主体 部分 Φ ,其“最短可判前缀”和“关键状态”的定义。为方便描述,我们先定义 一种偏序关系:假定对于路径 p = ... si...sj...sk,我们称 sj 是 si 和 si 两者中的较大 值,而称 si 是两者中的较小值。
                                                                                                                                                                                                                                                                                                                                                                                                 定义7. 最短可判前缀 对于路径p中状态s验证PCTL性质中的主体部分Φ 时,p 的最短可判前缀是始于 s 的、最短的、能够确定整条路径是否满足 Φ 的路 径前缀。
                                                                                                                                                                                                                                                                                                                                                                                                 定义 8. 关键状态 关键状态是最短可判前缀中最后一个状态。
                                                                                                                                                                                                                                                                                                                                                                                                 下面给出并证明一系列定理:通过它们可以根据状态 s 和不同性质公式,来 确定关键状态的位置。这样就可以在算法中,基于这些定理来找出对应的关键状 态。
                                                                                                                                                                                                                                                                                                                                                                                                 定理2当对状态s验证性质Φ= a (aŒAP),其中AP为原子公式集,则状态 s 对Φ的关键状态是 s 本身。
                                                                                                                                                                                                                                                                                                                                                                                                 证明 显然,由于性质为原子命题Φ=a(aŒAP)。因此,根据第二章中定义的 31
                                                                                                                                                                                                                                                                                                                                                                                                 第三章 基于预测的贝叶斯统计模型检测方法 3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                                   路径满足关系,s 本身满足 a 当且仅当始于 s 的所有路径满足 a,反之亦然。因 此,最短前缀就是<s>。
                                                                                                                                                                                                                                                                                                                                                                                                   定理 3 当对状态 s 验证性质Φ =!y ,其中y 为 PCTL 路径公式,则状态 s 对 Φ 的关键状态是 s 对y 的关键状态。
                                                                                                                                                                                                                                                                                                                                                                                                   证明 假设 s 对y 的最短可判前缀为 Pre2。先证 Pre2 可以确定 s 是否满足!y : 显然,如果 Pre2 可以确定 s 满足y ,则 Pre2 可以确定 s 不满足!y 。反之,如果 Pre2 可以确定 s 不满足y ,则 Pre2 可以确定 s 满足!y 。得证。
                                                                                                                                                                                                                                                                                                                                                                                                   再证不存在比 s 对y 的可判前缀更短的前缀:假设存在 s 对!y 的最短可判 前缀 Pre1,并且它短于 Pre2。如果通过前缀 Pre1 可以断定 s 满足!y ,则可以通过 Pre1 断定 s 不满足y 。反之,如果通过前缀 Pre1 可以断定 s 不满足!y ,则通过 Pre1 也可以断定满足y 。因此 Pre1 也是 s 的可判前缀,并且比 Pre2 更短。这便产 生矛盾。因此如果存在 Pre1,则它至少跟 Pre2 一样长。
                                                                                                                                                                                                                                                                                                                                                                                                   定理4当对状态s验证性质Φ=y1 Ÿy2,如果:
                                                                                                                                                                                                                                                                                                                                                                                                   a) s满足y1 且同时满足y2,则s对于y1 Ÿy2的关键状态是s对于y1
                                                                                                                                                                                                                                                                                                                                                                                                   的关键状态与 s 对于y 2 的关键状态的较大值。
                                                                                                                                                                                                                                                                                                                                                                                                   b) s不满足y1 且同时不满足y2,则s对于y1 Ÿy2的关键状态是s对于
                                                                                                                                                                                                                                                                                                                                                                                                   y1 的关键状态与s对于y2的关键状态的较小值。
                                                                                                                                                                                                                                                                                                                                                                                                   c) s仅满足y1 或y2,则s对于y1 Ÿy2的关键状态是s所不满足那个性
                                                                                                                                                                                                                                                                                                                                                                                                   质的关键状态。
                                                                                                                                                                                                                                                                                                                                                                                                   证明 先证 a),假设 s 对y 1 的最短可判前缀为 Pre1、s 对y 2 的最短可判前缀
                                                                                                                                                                                                                                                                                                                                                                                                   为Pre2。显然,由于s满足y1 且同时满足y2,因此Pre1可以判定s满足y1 , Pre2 可以判定 s 满足y 2 。Pre1 如果长于 Pre2,则 Pre1 包含的状态足够确定 s 满足 y2,因此Pre1可以确定s满足y1 Ÿy2。类似的,如果Pre2长于Pre1,则Pre2包 含Pre1,因此Pre2也足够确定s满足y1 Ÿy2。
                                                                                                                                                                                                                                                                                                                                                                                                   再证 b)。
                                                                                                                                                                                                                                                                                                                                                                                                   假设s对y1 的最短可判前缀为Pre1、s对y2的最短可判前缀为Pre2。如果 Pre1短于Pre2,由于Pre1可以判定s不满足y1 ,则Pre1包含的状态足够确定s
                                                                                                                                                                                                                                                                                                                                                                                                   32
                                                                                                                                                                                                                                                                                                                                                                                                   第三章 基于预测的贝叶斯统计模型检测方法 3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                                     不满足y1 Ÿy2。类似的,如果Pre2短于Pre1,则Pre2包含的状态也足够确定s不 满足y1 Ÿy2。
                                                                                                                                                                                                                                                                                                                                                                                                     再证 c)。
                                                                                                                                                                                                                                                                                                                                                                                                     假设s对y1 的最短可判前缀为Pre1、s对y2的最短可判前缀为Pre2。如果 Pre1能够确定s不满足y1 ,无论s是否满足y2,s都不满足y1 Ÿy2。因此Pre1 直接能确定s不满足y1 Ÿy2。
                                                                                                                                                                                                                                                                                                                                                                                                     同样地,如果Pre2能够确定s不满足y2,无论s是否满足y1 ,s都不满足 y1 Ÿy2。因此Pre2直接能确定s不满足y1 Ÿy2。
                                                                                                                                                                                                                                                                                                                                                                                                     定理5当对状态s验证性质Φ=y1 ⁄y2,如果:
                                                                                                                                                                                                                                                                                                                                                                                                     a) s 满足y1 且同时满足y2 ,则 s 对于y1 ⁄y2 的关键状态是 s 对于y1
                                                                                                                                                                                                                                                                                                                                                                                                     的关键状态与 s 对于y 2 的关键状态的较小值。
                                                                                                                                                                                                                                                                                                                                                                                                     b) s不满足y1 且同时不满足y2,则s对于y1 ⁄y2的关键状态是s对于
                                                                                                                                                                                                                                                                                                                                                                                                     y1 的关键状态与s对于y2的关键状态的较大值。
                                                                                                                                                                                                                                                                                                                                                                                                     c) s仅满足y1 或y2,则s对于y1 ⁄y2的关键状态是s所满足那个性质
                                                                                                                                                                                                                                                                                                                                                                                                     的关键状态。
                                                                                                                                                                                                                                                                                                                                                                                                     证明 先证 a),假设 s 对y 1 的最短可判前缀为 Pre1、s 对y 2 的最短可判前缀
                                                                                                                                                                                                                                                                                                                                                                                                     为Pre2。如果Pre1短于Pre2,由于Pre1可以判定s满足y1 ,则Pre1包含的状态 足够确定 s 满足y1 ⁄y 2 。类似的,如果 Pre2 短于 Pre1,则 Pre2 包含的状态也足 够确定s满足y1 ⁄y2。
                                                                                                                                                                                                                                                                                                                                                                                                     再证 b)。
                                                                                                                                                                                                                                                                                                                                                                                                     假设s对y1 的最短可判前缀为Pre1、s对y2的最短可判前缀为Pre2。显然, 由于 s 不满足y1 且同时不满足y2 ,因此 Pre1 可以判定 s 不满足y1 ,Pre2 可以 判定 s 不满足y 2 。Pre1 如果长于 Pre2,则 Pre1 包含的状态足够确定 s 不满足y 2 , 因此 Pre1 可以确定 s 不满足y1 ⁄y 2 。类似的,如果 Pre2 长于 Pre1,则 Pre2 包含 Pre1,因此Pre2也足够确定s不满足y1 ⁄y2。
                                                                                                                                                                                                                                                                                                                                                                                                     再证 c)。
                                                                                                                                                                                                                                                                                                                                                                                                     假设s对y1 的最短可判前缀为Pre1、s对y2的最短可判前缀为Pre2。如果
                                                                                                                                                                                                                                                                                                                                                                                                     33
                                                                                                                                                                                                                                                                                                                                                                                                     第三章 基于预测的贝叶斯统计模型检测方法 3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                                       Pre1能够确定s满足y1 ,无论s是否满足y2,s都满足y1 ⁄y2。因此Pre1直接 能确定s满足y1 ⁄y2。
                                                                                                                                                                                                                                                                                                                                                                                                       同样地,如果Pre2能够确定s满足y2 ,无论s是否满足y1 ,s都满足y1 ⁄y2 。 因此Pre2直接能确定s满足y1 ⁄y2。
                                                                                                                                                                                                                                                                                                                                                                                                       定理6当对状态s验证性质Φ=Oy (next操作符),则状态s对于Oy的关 键状态是路径 p 中,s 下一个状态对于y 的关键状态。
                                                                                                                                                                                                                                                                                                                                                                                                       证明 假设 s 下一个状态为 s1,并且 Pre1 可以确定 s1 是否满足y 。如果 Pre1 可以确定 s1 满足y ,则<s, Pre1>足够确定 s 满足y 。反之亦然。并且前缀<s, Pre1>与前缀 Pre1 的最后一个状态相同,因此 s1 的对于y 的关键状态就是 s 对于
                                                                                                                                                                                                                                                                                                                                                                                                       Φ=Oy 的关键状态。
                                                                                                                                                                                                                                                                                                                                                                                                       定理7当对状态s验证性质Φ=y1U£ny2 (until操作符),如果:
                                                                                                                                                                                                                                                                                                                                                                                                       a) s 不满足y1 U£n y2,如果第一个同时不满足y1和y2 的状态是 si,则 状态 s 对于y1 U£n y2的关键状态是从 s 开始到 si-1 所有状态对于y2 的关键状态与 si-1 对于y 1 和y 2 的关键状态的最大值。
                                                                                                                                                                                                                                                                                                                                                                                                       b) s 满足y1 U£ny2。如果第一个满足y2的状态是 si。则状态 s 对于 y1 U£n y2的关键状态是从 s 开始到 si 前一个状态的所有的状态对于 y 1 关键状态与 s2 对于y 2 的关键状态里的最大值。
                                                                                                                                                                                                                                                                                                                                                                                                       证明 先证 a),由于 s 不满足y1 U£n y2,则必定存在一个状态 si:si 既不满 足y 1 也不满足y 2 ,并且 s 到 si 之间所有的状态{s2, s3...si-1}都满足y 1 且不满足y 2 。 也就是说,要确定s不满足y1 U£ny2,(s!|= y2 )Ÿ (s1 !|= y2 )Ÿ (s2 !|= y2 )...Ÿ (si !|= y1 Ÿ si !|= y2 )必定为真,才能保证 s 不满足y1 U£n y2。将上述合取式展 开后,该合取式证明方法也类似定理 4 的的证明,故不再赘述。
                                                                                                                                                                                                                                                                                                                                                                                                       再证 b)
                                                                                                                                                                                                                                                                                                                                                                                                       由于s满足y1 U£ny2,则必定存在一个状态si:si满足y2,并且s到si之间 所有的状态{s2,s3...si-1}都满足y1。也就是说,要确定s满足y1 U£ny2,(s|= y1) Ÿ (s1 |= y1)Ÿ (s2 |= y1)...Ÿ (si |= y2 )必定为真,才能保证s满足y1 U£ny2。
                                                                                                                                                                                                                                                                                                                                                                                                       此合取式证明方法也类似定理 4 的的证明,故不再赘述。 34
                                                                                                                                                                                                                                                                                                                                                                                                       第三章 基于预测的贝叶斯统计模型检测方法 3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                                         但是这些还不够,我们需要找出整条有限路径的关键状态。重新假定 p[i]表 示路径中,第 i 个状态,则路径 p 对于 PCTL 性质 Φ 的关键状态可定义如下:
                                                                                                                                                                                                                                                                                                                                                                                                         定义 9. 路径对于 PCTL 主体的关键状态 路径 p 对于 PCTL 性质主体 Φ 的 关键状态,就是 p[1]对于性质 Φ 的关键状态。
                                                                                                                                                                                                                                                                                                                                                                                                         由于对应的算法所占篇幅较大,因此具体算法请见附录。通过该算法找出初 始状态对于给定性质的关键状态,就能够确定该条路径的最短可判前缀。从而在 下次抽样时,遇到包含相同可判前缀的路径时,通过该前缀就已经可以判断整条 路径是否满足性质。因此,可以直接对路径进行判定和记录,并直接开始下一次 抽样。这样不仅避免了时间复杂度较高的长路径验证,也省去了部分路径抽样所 消耗的时间。
                                                                                                                                                                                                                                                                                                                                                                                                         3.4.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                                         基于之前的讨论,现在的目标是:找到一种算法,它可以对有限路径进行验 证,并同时收集最短可判前缀。因此,首先给出抽样算法。它会在每个选择状态 的阶段中,根据已保存的最短可判前缀信息,来尝试判定该路径前缀是否满足给 定性质,以避免进入路径验证状态。其次,根据之前所列出的定理与附录中的算 法,它会在验证的过程中,保存最短可判前缀,并给出验证结果。由于对算法进 行启发式的改进是独立于该方法是参数估计式或假设检验式,故这里会先给出启 发式抽样算法,再分别给出基于启发式抽样算法改进后的面向定性和定量性质的 验证算法。
                                                                                                                                                                                                                                                                                                                                                                                                         启发式抽样算法见算法 6。它的输入参数分别是概率迁移模型 PTS、给定路 径长度 k 和已知的最短可判前缀映射函数 decided_prefixes。假定 s0 是初始状态、 y 是待验证的性质。则 decided_prefixes:Path(s0) Æ {p|=y , p | ≠ y }。开始验证后, 算法会根据 k,不断的随机选取下一个状态,来组成路径。而如果当前的路径前 缀是已知的最短路径前缀,则立即返回该路径前缀和其是否满足的结果。这样一 来,就能够在抽样时,不用每次都随机选取 k 个状态且对路径进行验证,就能直 接得到结果。
                                                                                                                                                                                                                                                                                                                                                                                                         35
                                                                                                                                                                                                                                                                                                                                                                                                         第三章 基于预测的贝叶斯统计模型检测方法 3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                                                算法 6.启发式随机路径抽样算法getRandomPath
                                                                                                                                                                                                                                                                                                                                                                                                                输入:模型 PTS, 路径长度 k, 最短可判前缀集合 decided_prefixes 输出:抽样路径 和 路径是否满足给定性质
                                                                                                                                                                                                                                                                                                                                                                                                                p = path() // 创建空路径
                                                                                                                                                                                                                                                                                                                                                                                                                isSat = “unknown” // 路径是否满足
                                                                                                                                                                                                                                                                                                                                                                                                                for i = 1 to k do
                                                                                                                                                                                                                                                                                                                                                                                                                    s = randomNextState() // 根据当前状态随机获取下个状态
                                                                                                                                                                                                                                                                                                                                                                                                                    p = p concat(s) // 将状态接上路径
                                                                                                                                                                                                                                                                                                                                                                                                                    if p in decided_prefixes then // p 是最短可判定前缀之一
                                                                                                                                                                                                                                                                                                                                                                                                                        isSat = decided_prefixes.find(p) // 获得 p 是否满足性质
                                                                                                                                                                                                                                                                                                                                                                                                                        return p, isSat //返回路径和该路径是否满足性质主体 else
                                                                                                                                                                                                                                                                                                                                                                                                                              continue
                                                                                                                                                                                                                                                                                                                                                                                                                                 end if
                                                                                                                                                                                                                                                                                                                                                                                                                                 end for
                                                                                                                                                                                                                                                                                                                                                                                                                                 return p, isSat
                                                                                                                                                                                                                                                                                                                                                                                                                                    面向定性性质的验证算法见算法 7。它对算法 3 进行了改造:增加了用于保 存最短可判前缀的功能。它的输入参数分别是模型 PTS、给定路径长度 k、可信 度参数 c、精度参数、最短可判前缀映射 decided_prefixes 和需要验证的性质主体 y 。首先,它会使用 APMC 的方法 sampleSize 来获得需要抽样的路径数量。并 根据该数量,来对模型进行随机路径抽样。不过在调用 getRandomPath 方法后, 它会先判断该路径是否已经被判定为满足或不满足。如果已判定,就跳过后续的 路径验证阶段,直接开始抽样下一条随机路径。如果 getRandomPath 返回的结果 是“unknown”的。则 getShortestPrefix 方法会根据验证结果和前一节的定理来获得 其最短可判前缀,并将其添加到最短路径前缀的映射中。这样就能够在下一次调
                                                                                                                                                                                                                                                                                                                                                                                                                                    36
                                                                                                                                                                                                                                                                                                                                                                                                                                    第三章 基于预测的贝叶斯统计模型检测方法 3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                                                                      用 getShortestPrefix 时,匹配更多的最短路径前缀。
                                                                                                                                                                                                                                                                                                                                                                                                                                           算法 7 改进的面向定性性质的 PBMC 算法
                                                                                                                                                                                                                                                                                                                                                                                                                                           输入:模型PTS, 性质主体ψ, 精度参数d , 可信度参数c, 路径长度k, 最 短可判前缀集合decided_prefixes, a, b
                                                                                                                                                                                                                                                                                                                                                                                                                                           输出:PTS 满足 P~q (y ) 的概率
                                                                                                                                                                                                                                                                                                                                                                                                                                           n0 = getMaxSampleSize(d , c, a , b ) //预测抽样数量上限
                                                                                                                                                                                                                                                                                                                                                                                                                                           x= 0
                                                                                                                                                                                                                                                                                                                                                                                                                                           for i = 0 to n0 do
                                                                                                                                                                                                                                                                                                                                                                                                                                               p, isSat = getRandomPath(PTS, k, decided_prefixes) n = n+1
                                                                                                                                                                                                                                                                                                                                                                                                                                               if isSat == True then // 判定为满足
                                                                                                                                                                                                                                                                                                                                                                                                                                                   x = x+1
                                                                                                                                                                                                                                                                                                                                                                                                                                                   continue
                                                                                                                                                                                                                                                                                                                                                                                                                                                   else if isSat == False then // 判定为不满足
                                                                                                                                                                                                                                                                                                                                                                                                                                                       continue
                                                                                                                                                                                                                                                                                                                                                                                                                                                       else // 没有匹配前缀
                                                                                                                                                                                                                                                                                                                                                                                                                                                           verify(p,ψ ) // 验证该条路径 if p |= ψ then
                                                                                                                                                                                                                                                                                                                                                                                                                                                           x = x+1
                                                                                                                                                                                                                                                                                                                                                                                                                                                           decided_prefixes.insert({prefix, True}) //保存前缀和 根据前缀判定的结果
                                                                                                                                                                                                                                                                                                                                                                                                                                                           else
                                                                                                                                                                                                                                                                                                                                                                                                                                                               decided_prefixes.insert({prefix, False})
                                                                                                                                                                                                                                                                                                                                                                                                                                                               end if end if
                                                                                                                                                                                                                                                                                                                                                                                                                                                               if predictQualitativeStatistic(d , n0, n, x, a , b ) then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      37
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      第三章 基于预测的贝叶斯统计模型检测方法 3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             return //直接返回概率阈值 end if
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             EX2 = Formula(7)(a ,b , n, x) //公式(7)计算后验期望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             con=calculateConfidence(q,r,c,a,b,n,x) //算法2计算可 信度
                                                                                                                                                                                                                                                                                                                                                                                                                                                                             if con≥c and EX2 ~ t then return PTS满足ψ
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 else
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     return PTS不满足ψ
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     end if end for
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     if~Œ{=,£,≥} then return PTS满足ψ
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         else
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             return PTS不满足ψ
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             end if
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                面向定量性质的验证算法见算法 8 。类似地,它也为算法 5 增加了用于保 存最短可判前缀的功能。它的输入参数分别是模型 PTS、给定路径长度 k、可信 度参数 c、精度参数d 、最短可判前缀映射 decided_prefixes 和需要验证的性质主 体y 。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     算法 8 改进的面向定量性质的验证算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     输入:模型PTS, 性质主体ψ, 精度参数d , 可信度参数c, 路径长度k, 最 短可判前缀集合decided_prefixes, a, b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     输出:PTS 满足 P~q (y ) 的概率
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     n0 = getMaxSampleSize(d , c, a , b ) //预测抽样数量上限
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        38
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        第三章 基于预测的贝叶斯统计模型检测方法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        3.4 启发式抽样与验证算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               x= 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               for i = 0 to n0 do
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   p, isSat = getRandomPath(PTS, k, decided_prefixes) n = n+1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   if isSat == True then // 判定为满足
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       x = x+1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       continue
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       else if isSat == False then // 判定为不满足
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           continue
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           else // 没有匹配前缀
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               verify(p,ψ ) // 验证该条路径 if p |= ψ then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               x = x+1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               decided_prefixes.insert({prefix, True}) else
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               decided_prefixes.insert({prefix, False}) end if
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               end if
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ifp|= ψ then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               x = x+1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               end if
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               if predictQuantitativeStatstic(d ,n0, n, x, EX2, a )
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   break end if
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   end for
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   EX2 = formular(7)(a ,b , n, x) //公式(7)计算后验期望 low = EX2-d
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      39
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      第三章 基于预测的贝叶斯统计模型检测方法 3.5 完整算法验证过程
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             high = EX2+d
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             if EX2-d < 0 then low = 0 end if if EX2+d > 1 then high = 1 end if return [low, high]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    3.5 完整算法验证过程
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    本节主要根据前三节所引入的算法,通过硬币模仿骰子的例子来进行完整的 介绍。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    这里继续使用骰子例子介绍面向定性性质的算法,由于面向定量算法的过程 类似,故不再赘述。假设我们尝试验证性质“在三次投掷次数内,最终所映射的 数字是 2 或 3 的概率大于 40%”。可用 PCTL 将该性质表示如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Pθ>0.4(trueU£3 (s2 ⁄s3)) (15) 假设我们将 Be(1, 1)作为先验分布,并且分别将可信度参数与精度参数设为
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0.01、0.01。根据算法 7,我们可能会经历下列验证过程: 第一步,根据不等式(6),我们能够得到抽样数量上限约为 249997 次。 第二步,进入路径抽样与验证过程。假设首次所抽样的路径为<s0, s1,2,3, s2,3,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    s2>。由于目前没有收集到任何可判前缀,因此进入路径验证阶段。 第三步,路径验证。显然该路径是不满足性质的,因为它最终达到的吸收状 态为 s4。所以路径验证结果返回不满足。而在验证的同时,算法会同时保存该路
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    径各个状态的关键状态。其过程如表 1 所示。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    对<s0, s1,2,3, s2,3, s2>验证时,收集关键路径的步骤如下: 首先,先对原子命题“true”进行验证。显然,对于原子命题“true”,所有状态
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    都是满足的。并且根据定理 2,它们的关键状态都是它们本身。因为它们本身的 原子命题集就能决定它们满足“true”。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    而对于 s2 和 s3,则路径前两个状态 s0、s1,2,3 的原子命题集不包含 s2 和 s3,所 以都不满足这两个性质。而 s2,3、s2 满足。与之前寻找关键状态的过程类似,它
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    40
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    第三章 基于预测的贝叶斯统计模型检测方法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    3.5 完整算法验证过程
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      们的关键状态也都是它们本身。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      表 1 收集关键状态的过程
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      状态           s2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          收集数据
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               s0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                s1,2,3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     s2,3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        是否满足 true
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              否
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 否
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      是
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         关键状态
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           s0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           s 1,2,3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             s2,3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                是否满足 s2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    否
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     否
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         是
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            关键状态
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  s0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     s 1,2,3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          s2,3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             是否满足s2 ⁄s3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               否
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               否
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 是
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    关键状态
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          s0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             s1,2,3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  s2,3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     是否满足
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     trueU£3 (s2 ⁄s3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       是
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       是
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         是
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            关键状态
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  s2,3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     s2,3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          s2,3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                验证原子命题 s2 验证原子命题 s3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                验证子性质s2 ⁄s3 验证子性质
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                trueU£3 (s2 ⁄s3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                是
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                s2 是 s2 是
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                s2 是
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                s2,3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            其次,基于之前的验证结果,开始对子性质s2 ⁄s3进行验证。显然,对于s0、 s1,2,3,该性质是不满足的。而对于 s2,3、s2,该性质是满足的。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            接下去再确定每个状态对于s2 ⁄s3的关键状态。根据定理5,因为s0既不满 足s2也不满足s3。所以s0对于s2 ⁄ s3的关键状态是s2、s3对于s2 ⁄ s3关键状态的 较大者。在本例中,两者的关键状态恰好相同,都是s0本身。所以s0对于s2 ⁄s3 的关键状态是 s0。而剩余状态的关键状态确定过程与 s0 类似,也都是本身。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            最后,对性质trueU£3 (s2 ⁄s3)进行验证。显然,路径<s0,s1,2,3,s2,3,s2>中所有 状态都满足该性质。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            再确定关键状态。在该条路径上,每个状态都满足 true,并且 s2,3 是最早在 该条路径上满足 s2 ⁄ s3 的状态。根据定理 5,我们取 s2,3 前所有状态的关键状态 的最大值,即 s2,3。所以所有状态的关键状态都是 s2,3。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            这时<s0, s1,2,3, s2,3, s2>所有状态对于性质(15)的关键状态便确定完了。根据 s0 的关键状态 s2,3。我们将可判前缀<s0, s1,2,3, s2,3>收集起来,并进行统计结果预判 与结果可信度计算。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            第四步,假设目前还无法预判统计结果或达到可信度要求,所以继续对模型
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            41
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            第三章 基于预测的贝叶斯统计模型检测方法 3.6 本章小结
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              进行路径抽样。假设本次在随机选取路径前三个状态时,恰好是<s0, s1,2,3, s2,3>。 该前缀与之前所收集的可判前缀一致,这时根据算法 7,则可以直接判定该路径 满足给定性质。因此,会跳过路径验证,直接进入统计结果预判与结果可信度计 算。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              假设经过多次第三步与第四步,我们总共抽样了13090次,并且其中有5236 个样本满足性质。但是可以发现,只需要 4 条可判前缀<s0, s1,2,3, s‘1,2,3 >、<s0, s1,2,3, s2,3 >、<s0, s4,5,6, s‘4,5,6 >和<s0, s4,5,6, s4,5 >就能对所有的路径进行判定。因此,最多 只需要验证 4 次,其余的路径可以通过所收集的可判前缀判定。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              此时根据统计结果预判方法 1,我们可以计算得到后验分布在 249997 次后, 其期望值还不属于[0.39,0.41]区间内,因此继续下一步计算结果的可信度。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              通过计算当前结果的可信度(算法 2),则可以得到 0.01 分位数为 0.39、而 0.99 分位数为 0.41。因此,结果的可信度已达到要求(不等式(5))。此时可以推 断模型满足性质的概率等于 0.4,因此模型不满足性质(15)。如果当前可信度还没 达到要求,则会继续进行路径抽样与验证。直到可以预判统计结果、可信度达到 要求或抽样数量达到抽样上限时,就会根据统计数据返回验证结果。整个算法结 束。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              3.6 本章小结
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              本章分别给出了面向定性性质和面向定量性质的 PBMC 算法,并详细介绍 抽样数量上限预测方法、结果可信度计算方法和两种统计结果预测方法。除此之 外,我们还引入了启发式抽样与验证算法,并给出了其与两类 PBMC 整合后的 完整算法。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              42
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              第四章 统计模型检测工具 SPAC 4.1 工具介绍
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                第四章 统计模型检测工具 SPAC
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                4.1 工具介绍
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                SPAC(Statistical Probabilistic Approximate Model Checker)是由我们开发的 一个统计模型检测功能工具。它主要使用 Python 2.7 与 C 语言来实现,并支持在 Linux 与 Windows 操作系统上进行统计模型检测。其图形操作界面如图 6 所示:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                图 6 SPAC 的图形操作界面
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Fig 6 SPAC’s graphical user interface SPAC 的主要特性如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ß 在建模方面,支持使用离散时间的马尔可夫链DTMC对系统进行建模, 并指定原子命题集。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ß 在性质指定方面,支持使用概率计算树逻辑PCTL对性质进行指定。 43
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 第四章 统计模型检测工具 SPAC 4.2 工具实现
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ß 在验证算法方面,支持使用PBMC、使用启发式算法改进的APMC来进 行验证。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   由于它对前一节所介绍的两种 PBMC 算法进行了实现,并同时实现了以启 发式抽样算法改进的 APMC 方法。因此可以分别使用这三种算法来对离散时间 的随机系统进行验证。在案例研究中,我们将主要基于 SPAC 所给出的验证结果 来评估 PBMC,并与 PRISM 中所支持的 SPRT 方法、APMC 方法进行比较。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   4.2 工具实现
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   图 7 SPAC 模块结构图
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Fig.7 Structure of SPAC
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   在结构方面,SPAC 可以看作是一个统计模型检测框架。其结构图见图 7。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   因为通过将常用功能(如路径抽样,路径验证等)进行了封装,这样各类统计模 型检测算法就能直接调用所提供的功能模块来实现。所以在 SPAC 中实现新的算 法时,就能通过很少的代码实现对应的验证算法。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   如果从模块角度来分,SPAC 主要包括:有限路径随机抽样模块、有限路径 验证模块、PCTL 语法解析模块、DTMC 模型构建模块、参数检查模块、各类统 计模型检测算法和其他界面配置相关模块。下面我们依次对各个模块的主要功能 进行介绍。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    44
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    第四章 统计模型检测工具 SPAC 4.2 工具实现 4.2.1 界面与配置模块
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    在验证前,我们需要进行模型建模和性质描述的工作。在建模方面,SPAC 的操作界面支持输入相应的 DTMC 状态、迁移和对应的原子命题集,从而完成 建模。性质描述需要分别在界面中指定 PCTL 中的概率阈值、概率阈值的操作符 和具体性质主体。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    除此之外,还需要指定统计模型检测算法,并提供相应的参数。我们可以通 过界面中的方法面板来完成这部分的工作。这样就完成了模型、性质和方法的指 定。点击“Check”按钮后,SPAC 便会开始准备构造各类数据结构,以便进行验证。 其关键代码如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        @Slot()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            def startChecking(self):
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   model = self.initModel()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          property = self.initProperty()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 approach = self.initApproach()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        provider = Provider(model, property, approach)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               provider.start()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               另外,界面模块还会在 SPAC 启动时,完成配置读入、界面样式读入等工作。 4.2.2 参数检查模块
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               为了保证在进入验证前,模型、性质与算法都是基本正确的。参数检查模块 会对分别对这三者进行检查。这也为以后加入新的方法,提供了一个统一的参数 检查入口。如果发现存在类似模型定义错误(如马尔可夫链的出边概率和不等于 1)或性质语法错误时,便将出错消息返回给界面模块,提示修改。而如果成功, 则会启动相应统计模型检测算法来进行参数估计或假设检验
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               4.2.3 DTMC 模型构建模块
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 45
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 第四章 统计模型检测工具 SPAC 4.2 工具实现
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   在参数检查的过程中,参数检查模块(即 Provider)会调用 DTMC 模型构建 模块(core_model)来实例化相应的 DTMC 实例对象(instance object)。模型构 建模块(core_model)包含了所有 SPAC 支持的模型定义方式。它会根据所输入 的模型状态、迁移和原子命题集等来形成便于计算机操作(如路径抽样、原子命 题集合获取等)的模型实例。目前 SPAC 对 DTMC 提供了支持。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   4.2.4 PCTL 语法解析模块
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   除了模型实例构建,参数检查模块(即 Provider)还会调用 PCTL 语法解析 模块,从而构建相应的性质实例对象。PCTL 语法解析模块主要使用 C 语言实现。 它会先检查所输入性质的语法,再形成相应的抽象语法树(abstract syntax tree), 从而便于验证的执行。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   4.2.5 统计模型检测算法模块
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   在完成模型与性质的实例化(instantiation)后,参数检查模块还会实例化 指定的统计模型检测算法模块,从而对模型验证给定性质。目前 SPAC 主要支持 PBMC 面向定性性质算法、PBMC 面向定量性质算法和改进的 APMC 验证算法。 它们都在统计模型检测算法模块中继承于 Approach 类,它们的继承关系如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   图 8 Approach 类的子类结构
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Fig.8 Structure of Approach class’s children
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   在父类 Approach 中,它加入了有限路径抽样模块,该模块对启发式抽样算
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   法(算法 6)进行了实现。从而每个 Approach 类的子类,都能够支持启发式的路 46
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    第四章 统计模型检测工具 SPAC 4.3 本章小结
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      径抽样与验证。我们将路径的可判前缀保存在哈希表中,从而在抽样时,能够快 速地查找到相应的可判前缀。其构造函数如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      def __init__(self, approach_type, path_length):
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Approach.__init__(self, approach_type)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            self.verifier = verifier
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               self.decided_prefixes = dict()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  self.path_length = path_length
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  在 Approach 的每个子类中(即 PBMC 和 APMC),都包含了相应统计模型 检测算法(如算法 7 算法 8 ),从而基于模型实例与性质实例来进行验证。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  4.2.6 有限路径验证模块
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  在验证的过程中,不仅需要不断对模型进行有限路径抽样,还需要对路径进 行验证。SPAC 实现了在有限路径上对于 PCTL 的验证模块 verifier。所以每个统 计模型检测算法模块都只需要直接调用该模块,就能完成路径验证。在 SPAC 中, 其调用代码如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  if self.verifier.verify(self, path, property.pctl):
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         satisfied += 1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         else: pass
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             可以发现,只需要调用 verifier 中的 verify 方法,就能对路径 path 验证性质。 简洁而快速。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             4.3 本章小结
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             本章介绍了统计模型检测工具 SPAC 的主要实现方法、框架结构、组成模块、 47
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             第四章 统计模型检测工具 SPAC 4.3 本章小结
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               和验证的主要过程。在下一章中,我们将基于 SPAC 来对案例进行研究。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               48
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               第五章 案例研究
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               5.1 基本介绍
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 第五章 案例研究
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 5.1 基本介绍
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 为了评估第三章所提出的算法,我们尝试使用 SPAC 对三个典型案例进行验 证,并将结果与另一种领先的模型检测工具 PRISM 进行比较。PRISM[36][37]是 由DaveParker等人所开发的概率模型检测工具。它支持多种统计模型检测方法, 并实现了 APMC(Approximate Probabilistic Model Checking)和 SPRT(Sequential Probability Ratio Test)。而另一模型检测工具 UPPAAL[44][45]也添加了对这两种 方法的支持。这也说明这两种算法相对认可度较高。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 我们会分别使用 SPAC 与 PRISM 来对三个不同案例进行验证。它们分别是 简单随机调度算法,同步领导者选举协议和 Herman 分布式算法。简单随机调度 算法由于其算法相对简单,因此可以通过统计学来直接计算出它的一些性质。通 过将验证所得结果与计算所得结果相比较,我们便可以评估各种方法的验证正确 率。而同步领导者选举协议与 Herman 分布式算法是两种用于分布式系统的协议 与算法。它们都是 PRISM Benchmark Suite[46]中的例子,主要用来测试概率模型 检测方法性能等方面的表现。因此,它们非常适合用来评估和比较各种不同的统 计模型检测算法。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 5.2 简单随机调度算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 在本节中,我们尝试研究一个简单随机调度的算法,这里我们主要将它用于 临界资源(打印机)的分配。这主要有二个原因:第一,相对于其他两个案例, 这个简单随机调度算法由于设计相对简单,因此方便直接根据手工推断来判断各 类验证方法的正确性。第二,由于调度理论上可以无限的进行下去,这比较适合
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 49
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 第五章 案例研究 5.2 简单随机调度算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   衡量在任意长度周期的情况下,启发式算法的作用。 在本节中,首先会先对简单随机调度算法进行介绍,并给出简单随机调度算
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   法的模型定义。其次,我们会引入一些可以手工推导的性质。最后,我们会对这 些性质使用 SPAC 与 PRISM 进行验证,并对结果进行讨论。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   5.2.1 简单随机调度算法介绍
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   首先介绍简单随机调度算法。假设有 N 个进程,一个打印机,一个调度器。 整个调度过程如下:从一开始,这些进程都需要使用打印机,因此会不断地向调 度器发起申请。当调度器把打印机分配给其中某个进程 Pi 之后,Pi 占用打印机的 时间为 i。在 Pi 使用完打印机之后,则立即把打印机交还给调度器。但是,一旦 Pi 完成交还,则又立即开始申请打印机。这样一来,整个过程就是“争抢、使用、 争抢”的过程。其中,由于每次都有 N 个进程申请打印机,调度器分配打印机给 进程 Pi 的概率为 i/(N(N+1)/2)。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   图 9 一种可能的打印机分配方案
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Fig.9 A possible plan of scheduling
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   举个例子,图 9 表示当 N=4 时一种可能的打印机分配方案,其中 x 轴表示
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   时间,y 轴表示进程。在一开始,由于 P4 首先获得了打印机,并在使用了 4 个时 间单位后,将打印机交还给调度器。相应的,打印机后来分别被 P2、P4、P3 等占
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    50
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    第五章 案例研究 5.2 简单随机调度算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      用。并且由于调度器分配打印机给 P4 的概率为 4/(4(4+1)/2)=0.4。因此它抢占到 打印机的次数最多,而 P3、P2 和 P1 在一般情况下,抢占到的次数会更少一些。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      而当 N=4 时,该模型在 PRISM 中的定义可见附录。 评估主要包括四部分:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ß 第一部分主要评估各类算法所得结果的正确性。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ß 第二部分主要评估各类面向定性性质算法在不同时间长度上验证相同
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      性质时的表现。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ß 第三部分则是评估在指定不同的先验函数时,PBMC在抽样数量,结果
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      正确性上的变化。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ß 第四部分则主要评估在不同概率阈值情况下,面向定性性质算法的抽样
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      次数与验证次数的变化。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      5.2.2 算法正确性评估
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      首先评估各类算法结果的正确性。假定 N=4,为了可以直接推断模型是否满 足性质,或模型满足性质的概率是多少。我们分别对以下性质进行验证:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ß 先是定性的性质:“在16个时间单位内,进程P4获得多于或等于4次打 印机的概率是否大于等于 5%?”
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ß 再是定量的性质:“在16个时间单位内,进程P4获得多于或等于4次打 印机的概率是多少?”
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      可以使用 PCTL 将这两个性质描述如下
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      P≥0.05 (trueU£16 process4_used_printer≥4) (16)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Pθ=? (trueU£16 process4_used_printer≥4) (17) 相应地,在 PRISM 中这两个性质可以表示为(其中 process4UsedPrinter 是
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      PRISM 中所定义的变量):
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      P ≥ 0.05 [F £ 16 process4Us edPrinter ≥ 4] (18)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      P = ?[F £ 16 process4UsedPrinter ≥ 4] (19) 进程 P4 每次占用打印机 4 个时间单位。因此,如果进程 P4 要在 16 个时间 单位内占用打印机超过 4 次,则 P4 必须连续成功占用打印机 4 次。而这个事件
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      51
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      第五章 案例研究 5.2 简单随机调度算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        出现的概率为0.44 =0.0256。因此,可以预见的是,对于性质(16),如果验证结果 是不满足的,则是正确的,反之则是错误的。而对于性质(17),如果所估计的概 率区间覆盖了 0.0256,则结果是正确的,反之则是错误的。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        方法相关的参数指定如下:PBMC 方法的可信度参数与精度参数分别设置为 0.99 和 0.005。而 APMC 的可信度参数与近似参数设定为 0.01 和 0.005。SPRT 的 I/II 类犯错概率和无关区间分别设定为 0.01 和 0.005。并将 PBMC 中先验函数指 定为 Be(1,1),表示不包含任何先验信息。实验分别对每个性质验证 10 次,并记 录其中结果正确的次数。表 2 为验证结果:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        表 2 PBMC、APMC 和 SPRT 的验证结果与正确性
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        方法 是否正确 面向定性性质的 正确 PBMC
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        面向定量性质的 正确 PBMC
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        APMC     正确 SPRT     正确
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        由于各类方法的应用场景不同,因此仅统计结果的正确性。可以发现,无论 是面向定量性质、或是面向定性性质,它们都给出了符合预期的结果。而 APMC 给出的点估计并不是完全精确,但考虑到 APMC 的精度参数设置为 0.005。所以, APMC 所给出的结果也是基本正确的。而这也说明这四种算法在犯错概率上都 可控,并且取得结果也具有足够的可信度。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        5.2.3 不同运行周期下的验证效率评估
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        接着进入第二部分,评估各类面向定性性质算法在不同时间长度上验证相同 性质时的表现。由于调度算法理论上可以永远调度下去。所以在对简单随机调度 算法模型进行路径抽样时,永远不会达到吸收状态。所以考虑在不同长度时间限 制的情况下,我们对相同性质进行验证。根据前文分析,路径验证相比路径抽样
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        的代价大得多。因此,我们主要比较不同方法的路径验证次数。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                结果
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     10 次否
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          [0.022, 0.032]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0.0262
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                10 次否
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              52
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              第五章 案例研究 5.2 简单随机调度算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                本次所针对的模型与上一部分相同(N=4),所验证的性质表示如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                P=? (trueU£t process4_used_printer≥5) (20)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                其中 t=100, 200, 300, 400 和 500。相应地,在 PRISM 中性质表示如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                P = ? [F £ t process4Us edPrinter ≥ 5)] (21)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                我们分别使用面向定量的 PBMC 方法与 APMC 对这 5 个性质进行验证。参 数设置与上一部分相同,得到结果如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                表 3 PBMC、APMC 的验证次数比较
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                T APMC 验证次数 100 26492
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                200 26492
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                300 26492
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                400 26492 500 26492
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                表 3 中的 t 表示时间界限,即抽样路径的长度。其中 APMC 每次所需的验 证次数都是相同的。这主要由于两个原因:(1)APMC 的抽样次数是由可信度参 数与近似参数决定的。所以参数一旦确定,其抽样所需样本数量也就确定了。(2) APMC 的路径验证次数与抽样次数相同。因为对于每次抽样,都需要对路径样本 进行验证。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                而 PBMC 的验证次数则少了许多。这是由于如果调度器运行的周期较长, 则进程 P4 占用打印机超过 5 次是一个大概率事件。在路径抽样的前期,P4 就很 有可能已经占用打印机 5 次了。所以可以直接通过匹配之前的可判前缀进行预 判,从而减少不必要的长路径验证。因此,PBMC 比较适合在一个长周期上,验 证以小概率或者大概率满足的性质。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                5.2.4 指定不同先验分布时的验证效率评估
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                进入第三部分,PBMC 主要使用了后验分布来对模型满足性质的概率进行推 断。除此之外,还能采用指定先验分布的方式,来加入先验信息来帮助验证执行。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        PBMC 验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             257
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  255
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       254
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            257
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 256
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 53
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 第五章 案例研究 5.2 简单随机调度算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   在这部分中,我们主要尝试在验证前,指定不同的先验函数。并观察所得结果正 确率和所需抽样验证数量的变化。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   我们分别指定三种不同先验分布来进行验证,它们是:不包含先验信息的先 验分布,包含正确先验信息的先验分布和包含错误先验信息的先验分布。我们使 用贝塔分布来作为先验分布。由于之前已经推得 P4 在 16 个时间单位内获得 4 次 打印机的概率为0.44 =0.0256。因此,对应地,我们分别将不包含先验信息的先验 分布,包含正确先验信息的先验分布和包含错误先验信息的先验分布指定为 Be(1, 1)、Be(3, 97)和 Be(10, 90)。它们的期望值分别为 0.5、0.03 和 0.1。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   下面使用面向定性性质的 PBMC 算法与 SPRT 进行比较。其中 PBMC 的可 信度参数和精度参数分别设置为 0.99 和 0.01,SPRT 方法的 I/II 类犯错概率和无 关区间(indifference region)设置为 0.01 和 0.01。验证结果如表 4。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   表 4 PBMC 在指定不同先验函数时的验证结果与验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   检测方法 SPRT-N/A 验证结果 不满足 验证次数 502
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   表 4 表示 PBMC 方法在指定不同先验函数时,所得到的验证结果和所需路 径抽样次数。对于验证结果,四种方法所给出的结果都是正确的。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   对于验证次数,当指定的先验函数包含正确先验信息时,验证次数最少。而 当指定的先验函数包含错误的先验信息时,所需验证次数最多。而当先验函数不 带先验信息时,所需的样本数量介于两者之间。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   因此,当指定不同的先验函数时,会对所需验证次数产生影响。对于带有正 确信息的先验分布,它带有的信息能够帮助减少所需样本数量。而对于带有错误 信息的先验分布,它的信息会产生误导。所以需要更多的样本去对后验分布进行 调整。所以反而会需要更多的样本。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   所以结论是:当对目前的先验信息不足或者没有把握,还是倾向于指定不包 含先验信息的先验分布函数。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         PBMC-Be(1, 1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          PBMC-Be(3, 97)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               PBMC-Be(10, 90)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    不满足
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     不满足
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          不满足
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               215
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   117
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         1031
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   54
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   第五章 案例研究 5.2 简单随机调度算法 5.2.5 不同概率阈值下的验证效率评估
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   最后,我们对定性算法在指定不同概率阈值的情况下进行比较。我们在这部 分将继续对 N=4 规模的简单随机调度算法进行验证。与第一部分所验证的定性 性质相同,在这部分我们验证“在16个时间单位内,进程P4获得多于或等于4次 打印机的概率是否大于 5%?”。不过不同的是我们分别将概率阈值指定为 0.05, 0.25,0.45,0.65,0.85 从而观察各个方法在不同指定不同概率阈值时,它们的抽 样数量变化。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   我们主要使用面向定性性质 PBMC 算法与 SPRT 来对这 5 个性质进行验证。 并且将面向定性性质 PBMC 的可信度参数和精度参数分别设置为 0.99 和 0.01, 而将 SPRT 的 I/II 犯错概率和无关区间设置为 0.01 和 0.01。并将 PBMC 中先验 函数指定为 Be(1,1)。验证结果如表 5。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   表 5 PBMC、SPRT 在指定不同概率阈值时的验证次数(同步领导者选举算法)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   概率阈值 SPRT 验证次数 0.05     401
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0.25     201
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0.45     136
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0.65     82 0.85     36
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   表 5 在每一列中,自上而下列出了指定不同概率阈值时,所需要的路径验证 次数。对于两种方法,它们所需的抽样次数都是从上而下依次减少。这是由于概 率阈值越接近实际模型满足性质的概率(即约 0.0256)时,就需要更多的样本来 分辨这两个值的大小。而相对于 SPRT,PBMC 所需的路径抽样次数更少一些。 并且当概率阈值为 0.05 时,PBMC 验证次数要少于 SPRT。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   这说明在验证过程中,统计结果预判与路径验证结果预判在很大程度上减少 了所需抽样数量,因此 PBMC 相较于 SPRT,其验证效率更高。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             PBMC 验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                225
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   33
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      8
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         5
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            55
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            第五章 案例研究
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            5.3 同步的领导者选举协议
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              5.3 同步的领导者选举协议
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              同步领导者选举协议是一种分布式协议,最初在[47]中提出。它的主要目的 是想在一群通过网络相互连接的主机中,选出其中一台作为领导者。而领导者后 续的工作与该协议无关。由于分布式协议的可拓展性,同步领导者协议可用于任 意规模的主机群。当网络的规模较大时,选出领导者所需时间的期望值是一个有 趣的性质。因此本节围绕此性质来评估各类统计模型检测算法。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              5.3.1 同步的领导者选举协议介绍
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              同步领导者协议假设所有主机组成一个环状网络。每个主机上都通过进程 Pi 进行通信。为方便介绍,假设进程从其中某个进程开始按顺时针编号,因此 Pi+1 是 Pi 顺时针方向的下一个进程。在协议的运行过程中,所有进程会相互比较“领 导值”,直到选出一个进程,它必须满足两点要求:(1) 该进程的“领导值”是唯一 的 (2)当有多个进程的“领导值”是唯一时,它的“领导值”是最大的。这就要求这 些主机上的每一对进程,都需要进行比较。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              首先,当算法开始时,假设有 N 个进程,而每个进程都需要从 0 到 K 之间 随机挑选一个整数,并将它作为自己的“领导值”。其次,每个进程 Pi 将自己的“领 导值”与下一个进程 Pi+1 进行比较:如果 Pi 的领导值与 Pi+1 的领导值是相同的, 则将自己的领导值标记为“不唯一的”。与此步骤类似,当进行下一次比较时,每 个进程Pi将自己的“领导值”与下下个进程Pi+2进行比较,同时再次根据实际情况 来标记自己的领导值是否唯一。最后,在完成 N-1 次比较后,则每个进程检查自 己是否是“唯一的”。当存在进程的领导值唯一,则选出领导值最大的进程作为领 导者。而当每个进程都存在有相同的领导值时,则再次重复整个过程。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              在本节中,我们主要考虑当 N=4、K=2 时,四种方法在验证时的不同表现。 并在最后使用 PBMC 来尝试估计当指定不同的 N 与 K 时,选出领导者所需要的 期望时间。该算法的模型定义请见附录。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              5.3.2 面向定量性质的验证效率评估
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              在本小节中,我们验证定量的性质:“当 N=4、K=2 时,环形网络在 20 个时 56
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              第五章 案例研究
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              5.3 同步的领导者选举协议
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                间单位内选出领导者的概率”。该性质用 PCTL 描述如下: P=? (trueU£20 elected)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                相应地,在 PRISM 中,该性质表示如下: P = ? [F £ 20 elected]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (22)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (23) 我们分别使用 PBMC 的定量性质验证方法与 APMC 来对这个性质进行验证。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                其中 PBMC 与 APMC 的参数的设置如表 6 的第一、第二列。PBMC 方法的先验 函数设为 Be(1,1)。其验证结果如表 6。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                表 6 PBMC、APMC 在指定不同参数时的验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                可信度参数 APMC 验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0.0005 41471
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0.001 38005
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0.005 29958
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0.01 105967
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0.01 26492
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0.01 6623
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0.01 2944
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                表 6 主要分为左右两部分:首先,第一列和第二列表示对两种方法所指定的 不同参数。第三列和第四列表示两种方法在指定不同参数时,所需要验证的次数。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                先横向比较,当对可信度与精度要求相同时,PBMC 所需要的验证次数要少 于 APMC 所需要的验证次数。并且两者所给出的验证结果也是基本一致的。这 说明 PBMC 的验证效率更高,并且结果的正确性也可以保证。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                再纵向比较,当所指定可信度参数变小(对可信度要求变高)或精度参数变 小时(对精度要求变高),两种方法所需要的验证数量都在上升。并且当精度参 数变小时,两种方法所需的验证次数上升更快。当精度参数从 0.03 减小为 0.005 时,PBMC 所需要的验证数量增长到 32.8 倍、APMC 增长到 35.99 倍。而当可信 度参数从 0.01 减小为 0.0005 时,PBMC 所需要的验证数量增长到 2.04 倍,APMC 增长到 1.56 倍。这说明一方面两种方法都比较适合用于验证对可信度要求较高
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                的场合。而另一方面两种方法都对精度要求比较敏感。当对结果的精度要求较高
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        精度参数/近似参数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            PBMC 验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0.01
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      7145
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0.01
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          6228
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0.01
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 4547
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0.005
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           15755
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0.01
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               3501
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0.02
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      915
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0.03
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                480
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   57
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   第五章 案例研究 5.3 同步的领导者选举协议
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     时,会需要比较多的样本来估计。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     5.3.3 指定不同先验分布时的验证效率评估
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     接下去通过指定不同的先验分布来对这个性质进行验证,从而评估先验分布 的作用。并且通过使用面向定量性质的 PBMC 算法,我们可以得到性质(22)的满 足概率属于[92.7,94.7]的区间。我们分别 Be(1,1)、Be(93,7)、Be(465,35)、Be(50,50) 和 Be(500,500)作为先验分布。它们分别是不包含先验信息的先验分布、包含弱 正确先验信息的先验分布、包含强正确先验信息的先验分布、包含弱错误的先验 信息的先验分布和包含强错误的先验信息的先验分布。强和弱分别表示先验分布 的方差小和大,通俗来说,它们表示先验分布中的信息指向性是否强。而错误的 先验信息表示先验分布式不符合实际情况的:如事件发生的实际概率是 0.9,但 是如果给出的先验分布的期望值为 0.2,则先验分布所提供的信息就是不符合实 际情况的。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     表 7 PBMC 在指定不同先验分布时的验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     检测方法 验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     PBMC-Be(1,1)       3822 PBMC-Be(93, 7) 3725 PBMC-Be(465, 35) 3440 PBMC-Be(50,50)       4456 PBMC-Be(500,500)       6125 APMC-N/A 26492
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     同上,我们分别使用 PBMC 的定量性质验证方法与 APMC 来对这个性质进 行验证。其中 PBMC 的可信度参数、精度参数分别指定为 0.01、0.01。而 APMC 的可信度参数、近似参数分别指定为 0.01、0.01。验证结果如表 7。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     表 7 中的每一行,表示在指定不同的先验分布时,其验证结果与所需验证次 数。其中 APMC 由于无法指定先验分布而记为 N/A。先看验证次数,当指定不 包含信息的先验分布时,它所需要的验证次数要多于指定包含强信息时的验证次
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     数,但要少于 APMC 所需的验证次数和包含弱错误信息的验证次数。而当指定 58
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             类型
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 验证结果
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    不包含先验信息
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         [0.929, 0.949]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             包含弱正确信息
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [0.921, 0.941]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   包含强正确信息
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [0.926, 0.946]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         包含弱错误信息
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [0.919, 0.939]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                包含强错误信息
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                [0.868, 0.888]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     不可指定先验分布
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0.937
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            第五章 案例研究 5.3 同步的领导者选举协议
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              包含弱正确信息的先验分布时,它所需的验证次数在 Be(1,1)和 Be(465,35)之间。 这说明正确先验分布能够减少所需抽样数量,提高验证效率。而当指定为弱错误 的先验信息时,其表现是与这个规律不一致的。这可能是在抽样过程中,样本所 包含的信息对弱错误信息做了的矫正,使得一部分样本所提供的信息被抵消,从 而需要更多的样本来做出统计。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              再看验证结果,只有当指定包含强错误的先验分布时,给出的结果与其他情 况的结果不一致。结合之前包含弱错误信息的情况和第三章中的观察:包含强先 验分布的方差在抽样前已经非常小。就算样本不断地对先验分布进行调整,但是 对后验分布的期望调整幅度已经很小。因此,样本抽样所起到的效果只是不断地 使后验函数的方差缩小,直到最后达到可信度和精度的要求。在这种情况下,所 给出的结果很容易出现错误。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              因此,当对先验信息的正确性把握较小时,应该采用不包含信息的分布函数 作为先验分布。而当对先验信息正确性把握较大时,则应该采用包含弱先验信息 的先验分布来减少抽样数量,而避免采用包含强先验信息的先验分布。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              5.3.4 不同概率阈值下的验证效率评估
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              在本小节中,我们依然对类似的性质进行验证,但是这里主要验证定性的性 质:“当 N=4、K=2 时,环形网络在 20 个时间单位内选出领导者的概率是否大于 q ”。并且我们分别指定q 为 0.2、0.4、0.6 和 0.8。该性质用 PCTL 描述如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              P≥q (trueU£20 elected) (24) 相应地,在 PRISM 中,该性质表示如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              P ≥ q [F £ 20 elected] (25) 这里我们分别使用 PBMC 的定性性质验证方法与 SPRT 来对这个性质进行 验证。其中 PBMC 的可信度参数、精度参数分别指定为 0.01、0.01。而 SPRT 的 I/II 类错误犯错概率、无关区间分别指定为 0.01、0.01。并且 PBMC 方法的先验
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              函数设为 Be(1,1)。其验证结果如图 10。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              图 10 中,横轴为q ,纵轴为所需要的路径验证次数。其中点线表示 PBMC
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              的结果、三角线表示 SPRT 的结果。先比较两个方法的情况,可以发现,PBMC 59
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              第五章 案例研究 5.3 同步的领导者选举协议
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                所需要的验证次数相对 SPRT 更少。再比较不同概率阈值时的情况:当概率阈值 较小时,两种方法所需要的验证次数都比较小。而当概率阈值不断变大时,两种 方法所需要的验证次数也在不断上升。根据之前估计结果,我们知道该环状网络 在 20 个时间单位内选举出领导者的概率约为 92%。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                这说明当概率阈值不断接近 92%时,我们就需要更多的样本来判断概率阈 值比实际概率大,或者相反。这样就使得两种方法的曲线都是单调上升的。而 PBMC 的验证次数更少,这可能由于两方面原因:一方面在样本数量不断上升时, 所收集到的可判定前缀也会增加。这使得前缀匹配的成功率上升,从而减少验证 次数。而另一方面,根据第三章中的分析,当样本数量不断变大时,后验函数的 期望值调整幅度会不断变小。而此时 PBMC 的预判算法就能根据后验函数期望 值的调整幅度来直接预判结果,从而使得抽样数量相对较少。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                图 10 PBMC、SPRT 在指定不同q 时的验证次数 Fig.10 Verifying time of PBMC and SPRT with different q
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                5.3.5 不同问题规模下的验证效率评估
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                在本小节中,我们主要尝试使用 PBMC 来估计不同问题规模下,在规定时 60
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  第五章 案例研究 5.3 同步的领导者选举协议
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    间单位内选举出领导者的概率。因此,我们尝试估计“当随机区间为 K 时,对于 一个包含 N 个进程的环状网络,在 t 个时间单位内选出领导者的概率”。该性质 用 PCTL 可以表述如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    P=? (trueU£t elected) (26) 相应地,在 PRISM 中,该性质表示如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    P = ?[F £ t elected] (27) 我们分别将 N 指定为 50、60、70、80、90 且分别同时将 t 指定为 51、61、
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    71、81、91,并将 K 分别指定为 10、9、8。这里我们主要使用面向定量性质的 PBMC 算法来进行验证。其中 PBMC 的可信度参数、精度参数分别指定为 0.01、 0.01。并且指定其先验函数为 Be(1,1)。验证结果如下,其中 x 轴表示 N,y 轴表 示路径验证的次数。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    图 11 PBMC 在验证不同规模问题时的验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Fig.11 Verifying times of PBMC for different scale cases
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    值得注意的是,虽然同步领导者协议的模型结构相对简单。但是当 N=90、 K=10 时,至少存在有 9010 个状态。而从图 11 可以发现,最多只需要一万多次路 径验证就能完成推断。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      61
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      第五章 案例研究 5.4 Herman 分布式算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        另外,当 N 不断增大而 K 不变时,验证次数反而变少了。这可能由于所验 证的性质满足概率在逐渐变小,从而使得后验分布很快就收敛到靠近 0 的一端。 这使得所需样本数量变少。这也体现出统计模型检测的验证时间复杂度与模型复 杂度无关。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        而当 N 不变 K 变小时,验证次数也会减小。这也是由相同的原因所导致。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        所以,PBMC 的验证时间复杂度与模型复杂度无关。因此,PBMC 适合用于 验证复杂度较高的随机系统。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        5.4 Herman 分布式算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        本章将对 Herman 分布式算法进行研究。这主要有两个原因:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        1. 它主要用于分布式系统的容错性设计,其算法复杂度会随着分布式系统规模 上升而上升。并且,它的部分性质目前还无法手工证明。因此,适合作为一
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          种典型的复杂随机系统来进行分析。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          2. 它是一种随机算法且不包含非确定性,因此可以使用之前引入的PTS来对其
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          进行建模。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          首先我们会对 Herman 分布式算法进行介绍。其次,会给出它相应的模型定
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          义,并介绍一些有趣的性质。最后,会分别使用 SPAC 与 PRISM 来对所提出的 性质进行验证,并对结果进行比较与分析。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          5.4.1 Herman 分布式算法介绍
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Herman 算法主要应用于分布式系统的自我稳定(self-stabilization)。这个概 念最初由 Dijkstra 在[48]中提出。通俗来说,它表示:从任意状态开始,系统总 会在有限个状态迁移后达到一个稳定状态。这样就能保证系统可以从各种异常或 者错误状态中恢复,从而提高系统容错性(fault-tolerance)。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          下面介绍 Herman 分布式算法的基本过程。这里先做一些假设:假设有一个 环形网络包含 N 台主机,并且每个主机上运行着一个进程 Pi。每一个进程 Pi 都 有一个硬币。而每个进程的硬币即可以正面朝上,也可以反面朝上。我们假设 Pi+1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          是 Pi 顺着顺时针方向的下一台主机。并约定:如果 Pi 的硬币朝向与 Pi+1 的朝向 62
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          第五章 案例研究 5.4 Herman 分布式算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            相同的话,则说明 Pi 具有令牌。而当整个环状网络中,只剩下一个令牌时,我们 称这个环状网络达到了稳定状态。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            在整个环状网络刚初始化时,要求至少有奇数个进程是持有令牌的。也就是 说,至少有奇数个进程,它的硬币朝向是与其下一个进程相同的。而其他进程的 硬币朝向,则是与下一个进程不同的。首先第一步,将所有不持有令牌进程的硬 币朝向,都改成与下一个进程的硬币朝向相同。第二步,对于所有具有令牌的进 程,将它们的硬币进行抛掷。而这个硬币正面朝上的概率为r =0.5。相应地,硬 币反面朝上的概率为 1- r 。这样就完成了一轮令牌传递。而当网络中的两个(或 两个以上)令牌相遇时,这两个令牌便会一起消失。在[49]已经证明,经过有限 次调整,网络最终肯定能够达到稳定状态。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            举个例子,一个基本的环状网络请见图 12,它是一个包含 7 个进程的环状 网络。其中 Pi(0)表示 Pi 的硬币正面朝上,而 Pi(1)表示 Pi 的硬币反面朝上。在初 始状态中,进程 P3、P4、P7 的硬币朝向分别与 P4、P5、P1 相同。因此在环状网络 中包含有 3 个令牌。之后开始第一轮调整,假设 P3、P4、P7 所掷的硬币分别是反 面、反面和正面。则在分别对没有令牌进程与有令牌进程的硬币进行调整后,我 们能得到图 12 中间的图。这是可以发现,P7 的令牌发生了转交,它将令牌转交 给了 P6。而 P3、P4 没有变化,它们依然持有令牌,只是硬币的朝向发生了改变。 然后再进行第二次调整,假设 P3、P4、P6 所掷的硬币分别是正面、反面和反面。 则在调整后,由于 P3、P4 的硬币朝向分别与 P4、P5 都已经不同。它们的令牌发 生了相遇,因此两个令牌一起消失。这时,整个网络中只有 P6 还持有令牌。因 此,我们称这个环状网络目前达到了稳定状态。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            可见,Herman 算法本身的逻辑并不复杂。但是通过手工来求得它的部分性 质却非常困难。如在最差情况下,达到稳定状态的期望时间。McIver 和 Morgan[49] 猜测在 3 个令牌平均分布在环状网络中时,期望时间的下界是 0.15N2。但还无法 给出其证明。Marta Kwiatkowska 等[19]尝试用概率模型检测方法工具 PRISM 来 证明这一结果。并证明在进程的数量不大于 21 时,McIver 和 Morgan 的猜测是 正确的。因此,本章也利用 SPAC 来验证这个性质,并与 PRISM 的验证结果相
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            63
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            第五章 案例研究
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            5.4 Herman 分布式算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              比较。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               图 12 一个简单的 Herman 自满足算法例子
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Fig.12 A simple example of Herman self-stabilization algorithm
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               由于 Herman 算法的模型定义与描述已经在[19]和 PRISM Benchmark Suite
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               中详细给出,故本文不再赘述。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               5.4.2 面向定量性质的验证效率评估
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               首先评估面向定量性质的算法。假设环状网络包含 21 个进程。其中三个进 程具有令牌。我们尝试估计:“该环状网络在 60 个时间单位内达到稳定状态的概 率”。具体性质表示如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               P=? (trueU£60 stable) (28) 而在 PRISM 中,类似的性质可以表示如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               P = ? (F £ 60 "stable") (29) 由于结果的可信度要求会影响统计模型检测的抽样与验证次数。因此,我们 将 PBMC 和 APMC 的参数分别如表 8 的第一、二列所示。并将 PBMC 中先验函
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               数指定为 Be(1,1)。具体结果如下: 表主要分为上下两部分,在上半部分中,我们固定了 APMC 的近似参数与
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               PBMC 的精度参数,而让可信度依次提高。而在下半部分中,我们固定了 APMC 和 PBMC 的可信度参数,而让近似参数或精度参数依次下降。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               通过比较 APMC 与 PBMC 的抽样数量,PBMC 所需要的抽样数量更少。而 当可信度提高时,两种方法所需要的抽样数量都会相应提高。观察表格的上半部
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               64
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               第五章 案例研究 5.4 Herman 分布式算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 分,在可信度参数为 0.001、近似参数为 0.01 时,APMC 所需要的抽样数量是两 个参数分别为 0.005、0.01 的约 1.65 倍。而对应的,PBMC 在两个参数分别为 0.9999 和 0.01 时,它所需的抽样数量是两个参数分别为 0.995 和 0.01 时的约 1.92 倍。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 表 8 PBMC、APMC 在指定不同参数时的验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 可信度参数 APMC 验证次数 0.0001 49518
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0.0005 41471
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0.001 38005
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0.005 29958
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0.01 105967
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0.01 26492
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0.01 6623
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0.01 2944
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 再观察表格的下半部分,当 APMC 可信度参数与近似参数分别为 0.01 和 0.005 时,所用的样本数量是两个参数为 0.01 和 0.03 时的 35.99 倍。而 PBMC 在 两个参数分别为 0.99 和 0.005 时所需要的抽样数量,是两个参数为 0.99 和 0.03 时的 36.05 倍。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 因此,PBMC 在大部分情况下的验证效率更高。并且两种方法在可信度提高 时,抽样数量提高不明显,所以它们对于可信度的提高不敏感。因此,它们都可 用于更高可信度的验证。然而,当提高近似参数或精度参数时,两种方法所需要 的抽样数量上升明显。因此它们对于精度上的要求都更加敏感。不过对于精度要 求不是非常高的场合,它们的效率也都是可接受的。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 5.4.3 不同运行周期下的验证效率评估
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 接下来验证第二部分的性质。因为我们在 PBMC 中采取了启发式抽样与验 证算法。为了评估它在不同时间长度上验证性质的效率变化。假设本次验证所针 对的环状网络具有 7 个进程,并且其中进程 P1、P3、P5 具有令牌。我们尝试估计
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         精度参数/近似参数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             PBMC 验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0.01
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        37106
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0.01
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  29682
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0.01
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      26557
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0.01
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             19315
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0.005
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       65013
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0.01
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           16311
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0.02
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  4059
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0.03
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            1803
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 65
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 第五章 案例研究 5.4 Herman 分布式算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   “在 10 个、15 个、20 个时间单位内,环状网络最终到达稳定状态的概率”。使 用拓展的 PCTL 性质可分别表示如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   P=? (trueU£t stable) t =10,15,20 (30) 在 PRISM 中,该性质可相应表示为:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   P = ? (F £ t "stable") t =10,15, 20 (31) 与之前相同,我们使用面向定量性质的 PBMC 与 APMC 来分别对这三个性 质进行验证。其中面向定量性质的 PBMC 可信度参数与精度参数分别设为 0.99、 0.01。而 APMC 的可信度参数与近似参数分别设为 0.01、0.01。并将 PBMC 中先
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   验函数指定为 Be(1,1)。验证结果如表 9:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   表 9 PBMC、APMC 在指定不同时间长度时的验证次数与结果
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           PBMC 验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               APMC 验证次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      11154
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          26492
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               4547
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     26492
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         1683
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           26492
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             T t=10 t=15 t=20
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             PBMC 验证结果 [0.816, 0.836] [0.916, 0.936] [0.964, 0.984]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     表 9 分别记录了 APMC 方法和 PBMC 方法在验证性质(30)时的主要结果。其中 路径验证次数是指实际对路径验证的次数。根据之前讨论,APMC 的路径验证次 数不变,总是 26492。而满足概率则是两类方法所给出的概率估计。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     在路径验证方面,PBMC 方法所需要的抽样次数要少于 APMC 的抽样次数。 但是 PBMC 在更长的时间上验证时,所需要抽样次数趋向于减少。而在路径验 证次数方面,PBMC 的路径验证次数也比 APMC 更少。最后,在估计结果方面, 两者所估计的值基本一致。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     根据上述观察可以发现:PBMC 不仅由于本身验证次数相对于 APMC 要少, 由于使用了启发式的抽样与验证算法,使得它在部分情况下路径验证次数上相比 APMC 减少一个数量级。并且值得注意的是,当所限的时间变长时,PBMC 的验 证次数反而减少了。这是因为对于包含 7 个进程的环状网络,它在 10 个时间单 位内达到稳定状态是一个大概率事件。因此,往往在还没达到 10 个时间单位时,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     环状网络就已经达到稳定状态了。而当 15,20 个时间单位时,它被满足的概率 66
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     第五章 案例研究 5.5 本章小结
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       更加大。这样一来,在路径抽样的过程中,就更容易匹配到可判前缀,从而避免 路径验证。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       因此,对于超长路径上大概率满足的性质或小概率满足的性质,使用启发式 抽样与验证算法的效率会更高。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       5.4.4 复杂问题的验证效率
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       这里我们尝试使用 PBMC 来验证规模较大的问题。我们对包含 21 个进程的 环状网络进行性质验证。在 PRISM 中可以显示该模型包含状态数量为 2, 097, 152, 包含的迁移数量为 10, 460, 353, 204。假设网络中各个进程硬币的初始状态为<1,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0>。而这里我们尝试验证“在 100 个 时间单位内,该环状网络最终到达稳定状态的概率”。性质可定义如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       P=? (trueU£t stable) t=100 (32) 在 PRISM 中,该性质可相应表示为:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       P=?(F£t "stable") t=100 (33) 我们使用面向定量性质的 PBMC 进行验证。其中可信度参数与精度参数分
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       别设为 0.99、0.01,并将 PBMC 中先验函数指定为 Be(1,1)。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       通过验证,包含 21 个进程的环状网络在 100 个时间单位内,达到稳定状态
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       的概率在[0.815, 0.835]区间内。而 SPAC 也仅用了几分钟就验证完成。这也与之 前的验证同步领导者选举时的过程类似。因此,PBMC 较适合应用与复杂随机系 统的验证。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       5.5 本章小结
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       在本章中,我们通过 SPAC 使用 PBMC 分别对简单随机调度算法、同步领 导者选举协议和 Herman 分布式协议进行了研究,再将验证结果与 PRISM 中的 APMC 与 SPRT 方法相比较。透过验证结果,可以发现 PBMC 的验证效率相比 前两者在一些场景下更高。而在对可信度较高与系统运行周期较长的情况下, PBMC 与启发式算法也都提升了算法的效率。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       67
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       第五章 案例研究
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         68
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         第六章 总结与展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         6.1 总结
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           第六章 总结与展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           6.1 总结
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           本文主要研究了对复杂随机系统的统计模型检测。为了使得模型检测能够应 用于长运行周期的复杂随机系统验证,我们提出了一种基于预测的贝叶斯统计模 型检测算法。它结合了贝叶斯推断与蒙特卡洛方法。这使得模型检测不再是一个 穷尽式搜索的过程,而是一次参数估计或是假设检验。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           我们主要引入了三种算法:面向定性性质的验证算法,面向定量性质的验证 算法与启发式抽样和验证算法。其中前两者分别面向定性性质和定量性质的验证, 而第三者主要用于验证运行周期较长的随机系统时,提高算法的效率。并且可以 与前两者结合进一步提高验证效率。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           对于面向定性和定量性质的验证算法,首先我们给出了基于贝叶斯推断的方 法框架。其次,我们引入了抽样数量上限预判方法、统计结果预判方法来改进原 先序贯抽样方案。这使得算法能够避免收集过多的样本来对后验分布做不必要的 调整。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           对于启发式抽样与验证算法,首先我们给出可判前缀搜索方法,并给出了相 应证明。其次我们给出了启发式抽样算法,它会根据所收集的可判前缀来对路径 验证结果进行预判。这使得算法能够在路径抽样阶段直接预判验证结果,从而避 开耗时的路径验证(尤其对于长路径)。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           在案例研究阶段,我们分别研究了三个案例。并使用基于三种算法实现的统 计模型检测工具 SPAC 来对这三个案例的一些有趣性质进行了验证。并将 SPAC 的验证数据与 PRISM 中所实现的两种算法 APMC、SPRT 相比较。发现 PBMC 方法的路径验证次数相较另两种方法都要少,同时验证结果的可信度与精度也得
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           69
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             以保证。这也证明本文所提出的方法能够提高对于复杂随机系统的验证效率,特 别是对长运行周期复杂随机系统的验证效率。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             就目前来说,不仅仅是网络技术,在气象、交通或者生物等方面也会存在各 种不同类型的随机系统。如果能够将统计模型检测技术应用于这些领域中各类系 统的研究,便可以从模型检测角度来验证各类系统的性质。而目前我们给出的方 法[50][51]主要用于验证离散时间的随机系统,并利用其他模型检测工具对一些 随机系统进行了分析[52]。因此,下一步的研究工作,可以从以下三方面展开:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             1. 目前我们主要将它应用于离散时间的随机系统。下一步会考虑进一步拓 展该算法的应用范围,如尝试将其用于验证连续时间的随机系统。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             2. 对于统计模型检测工具 SPAC,我们已经实现了本文所提出的三种算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             和改进的 APMC 算法,并提供了便于开发的框架和基本的图形交互环 境。下一步则考虑集成更多的算法,并根据 1 的研究成果继续完善其功 能与效率。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             3. 尝试使用 SPAC 来作为工具,研究各个领域中不同的随机系统。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             70
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             附录 A 启发式验证算法中的关键状态定位算法 6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               附录 A 启发式验证算法中的关键状态定位算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               这里给出启发式验证算法中的关键状态定位算法。为了使算法结构更加清晰, 我们使用函数 verifyAP(property)表示验证原子命题的算法,verfiy(property)表示 验证非原子命题性质的算法。并使用它们对(子)性质进行验证。而这会引起多 次发起递归(因为性质验证与定位关键状态的递归是分离的)。所以在实际应用 中,应该在验证性质的同时,使用定位算法来定位关键状态,从而减少发起递归 的次数。完整算法如下:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    算法 9 关键状态定位算法算法 getKeyState
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    输入:有限路径 p(这里表示为状态 s[i]组成的数组),(子)性质 property 输出:p 中各个状态的关键状态 key_states,各个状态是否满足性质 is_state_satisfied
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if property belongs to AP then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           is_state_satisfied[i] = verifyAP(property)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           key_states[i] = s[i]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           else if property is “!y ” then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  is_state_satisfied[i] = verify(property)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  key_states[i] = getKeyState(p, s[i], y ) else if property is “y 1 Ÿy 2 ” then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  is_state_satisfied[i] = verify(property) if is_state_satisfied[i] == False then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  if s[i] doesn’t satisfy y 1 and s[i] satisfies y 2 then key_states[i] = getKeyState(p, s[i], y 1 )
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         71
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         附录 A 启发式验证算法中的关键状态定位算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                else if s[i] satisfies y 1 and s[i] doesn’t satisfy y 2 then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    key_states[i] = getKeyState(p, s[i], y 2 ) else
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    key_states[i] = min(getKeyState(p, s[i], y 1 ), getKeyState(p, s[i], y 2 ))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    else
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        key_states[i] = max(getKeyState(p, s[i], y 1 ), getKeyState(p, s[i], y 2 ))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        end if
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        else if property is “y1 ⁄y 2 ” then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            is_state_satisfied[i] = verify(property) if is_state_satisfied[i] == True then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if s[i] doesn’t satisfy y 1 and s[i] satisfies y 2 then key_states[i] = getKeyState(p, s[i], y 2 )
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                else if s[i] satisfies y 1 and s[i] doesn’t satisfy y 2 then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    key_states[i] = getKeyState(p, s[i], y 1 ) else
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    key_states[i] = min(getKeyState(p, s[i], y 1 ), getKeyState(p, s[i], y 2 ))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    else
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        key_states[i] = max(getKeyState(p, s[i], y 1 ), getKeyState(p, s[i], y 2 ))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        else if property is “Oy ” then is_state_satisfied[i] = verify(property) key_states[i] = getKeyState(p, s[i+1], y )
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               72
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               附录 A 启发式验证算法中的关键状态定位算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      else if property is “y1 U£n y2” then is_state_satisfied[i] = verify(property) if is_state_satisfied[i] == True then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          // 假设根据 verify(property)得到最终满足y 2 的状态是 s[i+j],则有
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          key_states[i] = max(getKeyState(p, s[i], y 1 ), ... getKeyState(p, s[i+j], y 2 ))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          else
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              // 假设根据 verify(property)得到最终既不满足y 1 也不满足y 2 的
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              状态是 s[i+j],则有
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              key_states[i] = max(getKeyState(p, s[i], y 1 ) , ...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              getKeyState(p, s[i+j], y 1 ), getKeyState(p, s[i+j], !y 2 ))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              else
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  return “Syntax Error.”
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  return key_states, is_state_satisfied
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     73
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     附录 B 简单随机调度算法在 PRISM 中的模型定义 6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       附录 B 简单随机调度算法在 PRISM 中的模型定义
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       这里根据简单随机调度算法案例研究小节中的算法描述,给出在 N=4 时, 使用 The PRISM Language 对该算法的模型定义。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       定义 10. 使用 The PRISM Language 定义的简单随机调度算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            dtmc
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            module proc1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              x1:[0..1] init 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                x2:[0..1] init 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  x3:[0..1] init 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    x4:[0..1] init 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      x1used:[0..100] init 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        x2used:[0..100] init 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          x3used:[0..100] init 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            x4used:[0..100] init 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            []x1=0 & x2=0 & x3=0 & x4=0 -> 0.1:(x1'=0) & (x2'=0) & (x3'=0) & (x4'=0) & (x1used'=x1used+1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         + 0.2:(x1'=0) & (x2'=1) & (x3'=0) & (x4'=0)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      + 0.3:(x1'=0) & (x2'=0) & (x3'=2) & (x4'=0)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   + 0.4:(x1'=0) & (x2'=0) & (x3'=0) & (x4'=3);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      74
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             []x1=0 & x2=1 & x3=0 & x4=0 -> 1:(x1'=0) & (x2'=0) & (x3'=0) & (x4'=0) & (x2used'=x2used+1);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             []x1=0 & x2=0 & x3=2 & x4=0 -> 1:(x1'=0) & (x2'=0) & (x3'=1) & (x4'=0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             []x1=0 & x2=0 & x3=1 & x4=0 -> 1:(x1'=0) & (x2'=0) & (x3'=0) & (x4'=0) & (x3used'=x3used+1);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               []x1=0 &
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               & (x4'=2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 []x1=0 &
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 & (x4'=1);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 x2=0 & x3=0 & x4=3 -> 1:(x1'=0) & (x2'=0) & (x3'=0)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 x2=0 & x3=0 & x4=2 -> 1:(x1'=0) & (x2'=0) & (x3'=0)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 x2=0 & x3=0 & x4=1 -> 1:(x1'=0) & (x2'=0) & (x3'=0)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   []x1=0 &
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   & (x4'=0) & (x4used'=x4used+1);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   endmodule
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      75
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      附录 C 抽样上限预测算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        附录 C 抽样上限预测算法
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        当(6)中的等号成立时,可以使用下面算法,通过二分法来找到抽样上界。由 于该算法先通过对 n 每次增长 2 倍来获取用于二分查找抽样上限的上界。假设计 算机中整数的上限为 N,则只需要 logN/log2 次增长就能获得二分法上界,所以 是对数复杂度。而在第二部分中,会采用二分法来查找相应的抽样数量上界,因 此也是对数复杂度。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             算法 10 抽样上限的二分计算方法getMaxSampleSize 输入:可信度参数c,精度参数d, a, b
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             输出: 抽样数量上限
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             n = 1 //总实验次数
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             while VAR2_MAX(a,b, n) <= (1-c)d2 n =n*2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 low = n/2 // 二分法下界 high = n // 二分法上界 while(low <= high)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 mid = low + (high-low)/2 if VARMAX(a ,b , mid) ==
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 //使用公式(6)计算VAR2max
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 return mid
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 else if VARMAX(a ,b , mid) <= (1-c)d 2
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     low = mid+1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     else
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         high = mid–1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (1-c)d 2 then
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            76
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      end if
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      end while
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      return low-1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         77
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         附录 D 同步领导者选举协议在 PRISM 中的模型定义 6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           附录 D 同步领导者选举协议在 PRISM 中的模型定义
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           这里给出同步领导者选举协议在 PRISM 中的模型定义,它主要基于[46]中 示例修改。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           定义 11. 使用 The PRISM Language 定义同步领导者选举协议模型
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                dtmc
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // CONSTANTS
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const N=4; // number of processes
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const K=2; // range of probabilistic choice
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // counter module used to count the number of processes that have been read
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // and to know when a process has decided
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                module counter
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   // counter
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      c : [1..N-1];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         // reading
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [read] c<N-1 -> (c'=c+1);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               // finished reading
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [read] c=N-1 -> (c'=c);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     //done
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        [done] u1 | u2 | u3 | u4 -> (c'=c);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           // pick again reset counter
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              78
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              附录 D 同步领导者选举协议在 PRISM 中的模型定义 6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        [retry] !(u1 | u2 | u3 | u4) -> (c'=1);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           // loop (when finished to avoid deadlocks)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [loop] s1=3 -> (c'=c);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              endmodule
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              module process1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 // local state
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    s1 : [0..3];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       // s1=0 make random choice
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          // s1=1 reading
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             // s1=2 deciding
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // s1=3 finished
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   // has a unique id so far (initially true)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      u1 : bool;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         // value to be sent to next process in the ring (initially
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         sets this to its own value)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            v1 : [0..K-1];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               // random choice
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  p1 : [0..K-1];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  // pick value
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [pick] s1=0 -> 1/K : (s1'=1) & (p1'=0) & (v1'=0) & (u1'=true)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     79
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     附录 D 同步领导者选举协议在 PRISM 中的模型定义 6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (u1'=true);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            + 1/K : (s1'=1) & (p1'=1) & (v1'=1) &
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // read
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [read]s1=1& u1&!p1=v2&c<N-1->(u1'=true)&(v1'=v2); [read]s1=1& u1& p1=v2&c<N-1->(u1'=false)&(v1'=v2)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            & (p1'=0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [read] s1=1 & !u1 & c<N-1 -> (u1'=false) & (v1'=v2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // read and move to decide
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [read] s1=1 & u1 & !p1=v2 & c=N-1 -> (s1'=2) & (u1'=true)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            & (v1'=0) & (p1'=0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [read] s1=1 & u1 & p1=v2 & c=N-1 -> (s1'=2) & (u1'=false)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            & (v1'=0) & (p1'=0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            [read] s1=1 & !u1 & c=N-1 -> (s1'=2) & (u1'=false) &
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (v1'=0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               // done
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  [done] s1=2 -> (s1'=3) & (u1'=false) & (v1'=0) & (p1'=0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     //retry
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        [retry] s1=2 -> (s1'=0) & (u1'=false) & (v1'=0) & (p1'=0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           // loop (when finished to avoid deadlocks)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [loop] s1=3 -> (s1'=3);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              endmodule
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              // construct remaining processes through renaming
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              module process2=process1[s1=s2,p1=p2,v1=v2,u1=u2,v2=v3] endmodule
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 80
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 附录 D 同步领导者选举协议在 PRISM 中的模型定义 6.2 展望
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        module process3=process1[s1=s3,p1=p3,v1=v3,u1=u3,v2=v4] endmodule
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        module process4=process1[s1=s4,p1=p4,v1=v4,u1=u4,v2=v1] endmodule
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // REWARDS -expected number of rounds
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        rewards "rounds"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           [pick] true : 1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           endrewards
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              81
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              附录 E 读硕士学会期间发表论文和科研情况
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [1] He, J., Zhang, M., He, K., & Guo, Y. (2016, September). Bayesian Statistical Model Checking for Complex Stochastic Systems. In Theoretical Aspects of Software Engineering (TASE), 2016 International Symposium on (pp. -). IEEE. (EI,已录用)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [2] 何佳, 张敏, 郭延楠等.面向复杂随机系统的启发式统计模型检测方法. 计算 机应用研究[J].2016, 第 12 期, -. (国内核心,已录用)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [3] He, K., Zhang, M., He, J., & Chen, Y. (2015, September). Probabilistic Model Checking of Pipe protocol. In Theoretical Aspects of Software Engineering (TASE), 2015 International Symposium on (pp. 135-138). IEEE.(EI,已录用)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [4] 基于概率的统计模型近似模型验证工具软件SPAC,登记号2016SR017303
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              附录 F 参与科研项目情况
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [1] 国家自然科学基金(No.61361136002):“信息物理融合系统的基础研究”
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [2] 国家自然科学基金青年科学基金:(No.61202105):“状态转换系统的格值 量化验证方法研究”
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              82
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              参考文献
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [1] Clarke E M, Emerson E A. Design and synthesis of synchronization skeletons using branching time temporal logic[M]. Springer Berlin Heidelberg, 1981.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [2] Edmund M. Clarke. Model Checking[M]. London, England: The MIT Press, 1997.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [3] Queille J P, Sifakis J. Specification and verification of concurrent systems in CESAR[C].International Symposium on Programming. Springer Berlin Heidelberg, 1982: 337-351.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [4] HughesGE,CresswellMJ.Anewintroductiontomodallogic[M].Psychology Press, 1996.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [5] Pnueli A. The temporal logic of programs[C].Foundations of Computer Science, 1977., 18th Annual Symposium on. IEEE, 1977: 46-57.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [6] Ben-Ari M, Pnueli A, Manna Z. The temporal logic of branching time[J]. Acta informatica, 1983, 20(3): 207-226.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [7] BurchJR.Tracealgebraforautomaticverificationofreal-timeconcurrent systems[R]. Carnegie-Mellon Univ Pittsburgh PA School of Computer Science, 1992.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [8] KwiatkowskaM,NormanG,ParkerD.Stochasticmodelchecking[M].Formal methods for performance evaluation. Springer Berlin Heidelberg, 2007: 220-270.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [9] Hakan Younes, Marta Z. Kwiatkowska, Gethin Norman. Numerical vs. statistical probabilistic model checking [J]. International Journal on Software Tools for Technology Transfer, 2006, 8(3):216-228.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [10]Hansson H, Jonsson B. A logic for reasoning about time and reliability[J]. Formal aspects of computing, 1994, 6(5): 512-535.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [11]Baier C, Haverkort B, Hermanns H, et al. Model-checking algorithms for continuous-time Markov chains[J]. Software Engineering, IEEE Transactions on,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              83
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              2003, 29(6): 524-541.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [12]Rutten J J M M, Kwiatkowska M, Norman G, et al. Mathematical techniques for analyzing concurrent and probabilistic systems[M]. American Mathematical Soc., 2004.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [13]López G G I, Hermanns H, Katoen J P. Beyond memoryless distributions: Model checking semi-Markov chains[M]. Process Algebra and Probabilistic Methods. Performance Modelling and Verification. Springer Berlin Heidelberg, 2001: 57-70.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [14]Burch J R, Clarke E M, McMillan K L, et al. Symbolic model checking: 1020 states and beyond[J]. Information and computation, 1992, 98(2): 142-170.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [15] McMillanKL,CheckingSM.AnApproachtotheStateExplosionProblem," CMU Tech Rpt[R]. CMU-CS-92-131.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [16]Godefroid P, Pirottin D. Refining dependencies improves partial-order verification methods[C]. Computer Aided Verification. Springer Berlin Heidelberg, 1993: 438-449.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [17]Peled D. Combining partial order reductions with on-the-fly model-checking[C]. Computer aided verification. Springer Berlin Heidelberg, 1994: 377-390.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [18]Valmari A. A stubborn attack on state explosion[C]. Computer-Aided Verification. Springer Berlin Heidelberg, 1990: 156-165.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [19]Kwiatkowska M, Norman G, Parker D. Probabilistic verification of Herman’s self-stabilisation algorithm[J]. Formal Aspects of Computing, 2012, 24(4-6): 661- 670.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [20]Youngmin Kwon, Gul Agha. Performance Modeling of Mobile Sensor Networks [A]. In: Ad-Hoc, Mobile, and Wireless Networks ed. Morelia, Mexico[C]. Proceedings, 2007, 262-272.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [21]Du De-hui, Chen Ming-song, Liu Xiao, et al. A novel quantitative evaluation approach for software project schedules using statistical model checking [A]. In: International Conference on Software Engineering ed. Hyderabad, India[C]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [22]Jha S K, Clarke E M, Langmead C J, et al. A bayesian approach to model checking biological systems[C]. Computational Methods in Systems Biology. Springer Berlin Heidelberg, 2009: 218-234.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [23]Heath J, Kwiatkowska M, Norman G, et al. Probabilistic model checking of complex biological pathways[J]. Theoretical Computer Science, 2008, 391(3):
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              84
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              239-257.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [24]Christel Baier, Marta Z. Kwiatkowska. On the Verification of Qualitative Properties of Probabilistic Processes under Fairness Constraints [J]. Information Processing Letters, 1998, 66(2):71-79.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [25]Thomas Herault, Richard Lassaigne, Frederic Magniette. Approximate Probabilistic Model Checking [A]. In: Verification, Model Checking, and Abstract Interpretation ed. Venice[C]. Proceedings, 2004, 73-84.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [26]Zuliani P, Platzer A, Clarke E M. Bayesian statistical model checking with application to Stateflow/Simulink verification[J]. Formal Methods in System Design, 2013, 43(2): 338-367.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [27]Walpole R E, Myers R H, Myers S L, et al. Probability and statistics for engineers and scientists[M]. New York: Macmillan, 1993.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [28]Duncan A J. Quality control and industrial statistics[J]. 1974.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [29]Grubbs F E. On designing single sampling inspection plans[J]. The Annals of Mathematical Statistics, 1949: 242-256.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [30]Wald A, Wolfowitz J. Optimum character of the sequential probability ratio test[J]. The Annals of Mathematical Statistics, 1948: 326-339.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [31]Younes H L S, Musliner D J. Probabilistic plan verification through acceptance sampling[C]. Proceedings of the AIPS-02 Workshop on Planning via Model Checking. 2002: 81-88.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [32]Herman T. Probabilistic self-stabilization[J]. Information Processing Letters, 1990, 35(2): 63-67.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [33]Baier C, Katoen J P. Principles of model checking[M]. Cambridge: MIT press, 2008.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [34]Hoeffding W. Probability inequalities for sums of bounded random variables[J]. Journal of the American statistical association, 1963, 58(301): 13-30.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [35]Raiffa H. Applied statistical decision theory[J]. 1974.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [36]Kwiatkowska M, Norman G, Parker D. PRISM 4.0: Verification of probabilistic real-time systems[C]. Computer aided verification. Springer Berlin Heidelberg, 2011: 585-591.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              85
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [37]Kwiatkowska M, Norman G, Parker D. PRISM: Probabilistic symbolic model checker[M]. Computer performance evaluation: modelling techniques and tools. Springer Berlin Heidelberg, 2002: 200-204.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [38]Pnueli A, Zuck L. Verification of multiprocess probabilistic protocols[J]. Distributed Computing, 1986, 1(1): 53-72.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [39]Younes H L S, Simmons R G. Statistical probabilistic model checking with a focus on time-bounded properties[J]. Information and Computation, 2006, 204(9): 1368-1409.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [40]Jeffreys H. The theory of probability[M]. OUP Oxford, 1998.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [41]Vardi M Y. Automatic verification of probabilistic concurrent finite state programs[C]. Foundations of Computer Science, 1985., 26th Annual Symposium on. IEEE, 1985: 327-338.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [42]Marquis De Laplace P S. Théorie analytique des probabilités[M]. V. Courcier, 1820.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [43]Knuth D E, Yao A C. The complexity of nonuniform random number generation[J]. Algorithms and complexity: new directions and recent results, 1976: 357-428. Larsen K G, Pettersson P, Yi W. UPPAAL in a nutshell[J]. International Journal on Software Tools for Technology Transfer (STTT), 1997, 1(1): 134-152.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [44]Alexandre David, Kim G. Larsen, Axel Legay, et al. Uppaal SMC Tutorial [J]. International Journal on Software Tools for Technology Transfer, 2015, 17(4):397-415
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [45]Behrmann G, David A, Larsen K G. A tutorial on uppaal[M]. Formal methods for the design of real-time systems. Springer Berlin Heidelberg, 2004: 200-236.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [46]Kwiatkowska M Z, Norman G, Parker D. The PRISM Benchmark Suite[C]. QEST. 2012: 203-204.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [47]Itai A, Rodeh M. Symmetry breaking in distributed networks[J]. Information and Computation, 1990, 88(1): 60-87.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [48]Dijkstra E W. Self-stabilization in spite of distributed control[M]. Selected writings on computing: a personal perspective. Springer New York, 1982: 41-46.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [49]Annabelle McIver, Carroll Morgan. An elementary proof that Herman's Ring is Theta [J]. Information Processing Letters, 2005, 94(2):79-84.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              86
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [50]He, J., Zhang, M., He, K., & Guo, Y. (2016, September). Bayesian Statistical Model Checking for Complex Stochastic Systems. In Theoretical Aspects of Software Engineering (TASE), 2016 International Symposium on (pp. -).
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [51]何佳, 张敏, 郭延楠等.面向复杂随机系统的启发式统计模型检测方法. 计算 机应用研究[J].2016, 第 12 期, -.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [52]He, K., Zhang, M., He, J., & Chen, Y. (2015, September). Probabilistic Model Checking of Pipe protocol. In Theoretical Aspects of Software Engineering (TASE), 2015 International Symposium on (pp. 135-138).
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              87
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              致谢
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              科研是综合多方面的脑力劳动,而在这三年的劳动过程中,我意 识到了自己在许多方面的不足。俗话说“好学近乎知,力行近乎仁, 知耻近乎勇”。要先发现问题,才能解决问题。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              在完成本文研究内容的过程中,首先需要感谢我的导师张敏,因 为她不仅教会了我不少科研上的知识,我也学到了不少为人处世的道 理。另外,师弟师妹和周围的同学给予了我不少帮助,从而少走了不 少弯路。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                最后感谢父母对于自己在求学路上的支持。
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                88

